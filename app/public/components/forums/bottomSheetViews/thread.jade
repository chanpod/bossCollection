script#threadComments(type="text/ng-template")
    md-dialog(layout = "column").md-list.md-has-header.commentsDialog
        md-toolbar()
            div(layout).md-toolbar-tools
                {{object.title}}
                span(flex)
                md-button(ng-click = "cancel()").md-icon-button
                    md-icon(md-font-library="material-icons", aria-label = "edit category") close
        div().threadComments
            md-card
                md-card-title
                    md-card-title-text
                        h3
                            {{object.user}}
                md-divider
                md-card-content
                    p
                        display-markdown(markdown = "object.message") 
                    div(flex, layout = "row", layout-align = "end center")
                        //message buttons if needed
                        
                    md-divider()
                    
                    md-card
                        md-card-content().threadReply 
                            div(flex, layout = "column", ng-if = "replying")
                                div(flex, layout = "row",  layout-align="end center")
                                    md-button(flex, ng-click = "saveComment()").md-raised.md-primary
                                        | Save
                                    md-button(flex, ng-click = "cancelComment()").md-raised.md-primary
                                        | Cancel
                                div(flex)
                                    input-markdown(flex, input = "object.newComment")
                                    
                                    
                    md-card(ng-if = "confirmDeleteBool")
                        md-card-content().confirmCommentDelete.md-whiteframe-20dp
                            div(flex, layout = "column", layout-align = "center center")
                                span()
                                    h3
                                        | Warning!!!
                                    span()
                                        | You are about to delete this comment. This action is irreversible. Are you sure?
                                div(layout)
                                    md-button(ng-click = "deleteComment()").md-raised.md-primary
                                        | Confirm
                                    md-button(ng-click = "cancelCommentDelete()").md-raised.md-primary
                                        | Nevermind!
                    div(layout = "row", layout-align = "space-between center")
                        md-input-container().md-block.md-icon-float
                            label() Search
                            md-icon(md-font-library="material-icons") search
                            input(type = "text", ng-model = "threadSearch")
                        div()
                            | Sort by date
                            md-button(ng-click = "orderByDateCreated()").md-icon-button
                                md-icon(md-font-library="material-icons") keyboard_arrow_up
                            md-button(ng-click = "orderByDateCreatedReversed()").md-icon-button
                                md-icon(md-font-library="material-icons") keyboard_arrow_down

                            
                    md-card(ng-repeat = "comment in object.comments | filter:threadSearch | orderBy:orderBy").md-whiteframe-10dp
                        md-card-content
                        
                            div(layout = "column")
                                div(flex).md-list-item-text
                                    div(layout-align = "space-between center", layout)
                                        h3(flex)
                                            {{comment.user}}
                                        div(flex)
                                            {{formatDate(comment.dateCreated)}}
                                        
                                    md-divider
                                            display-markdown(markdown = "comment.message", ng-if = "!comment.editing")
                                            div(flex, layout = "column", ng-if = "comment.editing")
                                                div(flex, layout = "row",  layout-align="end center")
                                                    md-button(flex, ng-click = "saveCommentEdit(comment)").md-raised.md-primary
                                                        | Save
                                                    md-button(flex, ng-click = "cancelCommentEdit(comment)").md-raised.md-primary
                                                        | Cancel
                                                div(flex)
                                                    input-markdown(flex, input = "comment.message")
                                                    
                                div(flex, layout = "row", layout-align = "end center", ng-show = "user.rank > 2 || user.name == comment.user")
                                    md-button(ng-click = "confirmDelete(comment)").md-icon-button
                                        md-icon(md-font-library="material-icons", aria-label = "delete comment") delete
                                    md-button(ng-click = "comment.editing = true").md-icon-button
                                        md-icon(md-font-library="material-icons", aria-label = "edit comment") mode_edit
                                
                            
                        md-list-item(style = "height = 50px;")
        
        md-button(ng-click = "openCommentBox()", ng-if = "!replying", aria-label = "reply", layout-align = "end center").md-fab.md-primary.reply
            md-icon(md-font-library="material-icons", aria-label = "edit category") reply
        
                                    
                                
                                