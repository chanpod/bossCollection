"use strict";angular.module("BossCollection",["BossCollection.controllers","BossCollection.services","BossCollection.directives","ngRoute","ngResource","btford.socket-io","ngCookies"]).factory("mySocket",["socketFactory",function(a){return a()}]).config(["$routeProvider","$locationProvider","$httpProvider","$sceDelegateProvider",function(a,b,c,d){a.when("/",{templateUrl:"home",controller:"homeController"}).when("/strategyRoom/:raid",{templateUrl:"strategyRoom",controller:"strategyRoomController"}).when("/roster",{templateUrl:"roster",controller:"rosterController"}).when("/auth/login",{templateUrl:"login",controller:"loginController"}).when("/auth/signup",{templateUrl:"signup",controller:"signupController"}).when("/forum",{templateUrl:"forums",controller:"forumsController"}).when("/auth/updateAccount",{templateUrl:"editAccount",controller:"editAccountController"}).when("/auth/application",{templateUrl:"application",controller:"applicationController"}).when("/reviewApplications",{templateUrl:"reviewApplications",controller:"applicationsReviewController"}).otherwise({redirectTo:"/"}),b.hashPrefix("!"),d.resourceUrlWhitelist(["self","https://www.youtube.com/**","https://pagead2.googlesyndication.com"]),b.html5Mode(!0)}]),angular.module("BossCollection.controllers",[]).controller("editAccountController",["$scope","$location","$http","userLoginSrvc",function(a,b,c,d){d.getUser().then(function(b){console.log("Got the user"),a.user=b}),a.updateAccount=function(){console.log("Updating account"),d.updateAccount(a.user).then(function(a){Materialize.toast("User updated")},function(a){Materialize.toast(a)})},a.alreadyLoggedIn=function(){1!=d.loggedIn()&&b.path("/auth/login")}}]),angular.module("BossCollection.controllers").controller("loginController",["$scope","$location","$http","userLoginSrvc",function(a,b,c,d){a.user={},a.user=d.getUser(),a.alreadyLoggedIn=function(){1==d.loggedIn()&&b.path("/")},a.login=function(){d.login(a.user).then(function(a){console.log(a)},function(a){Materialize.toast(a),console.log(a)})}}]),angular.module("BossCollection.controllers").controller("signupController",["$scope","$location","$http","$timeout","userLoginSrvc",function(a,b,c,d,e){a.user={},a.register=function(){e.registerNewUser(a.user).then(function(a){console.log(a)},function(a){Materialize.toast(a),console.log(a)})}}]),angular.module("BossCollection.controllers").controller("applicationController",["$scope","$location","$http","$timeout","realmServices","guildServices",function(a,b,c,d,e,f){console.log("Loading application ctrl..."),a.application={};try{(adsbygoogle=window.adsbygoogle||[]).push({})}catch(g){}a.validCharacterName=!1,e.getRealms().then(function(b){a.realms=b,d(function(){$("select").material_select()},100)}),a.validateCharactername=function(){a.validCharacterName=!1,f.validateCharacterName(a.application.characterName,a.application.realm.name).then(function(b){a.validCharacterName=!0,a.application.character=b},function(b){a.validCharacterName=!1})},a.submitApplication=function(){0==a.validCharacterName?Materialize.toast("Sorry, we couldn't find your character. Please verify your Realm and Character are correct."):f.submitApplication(a.application).then(function(a){b.path("/reviewApplications")},function(a){Materialize.toast(a)})}}]),angular.module("BossCollection.controllers").controller("applicationsReviewController",["$scope","$location","$http","$timeout","guildServices",function(a,b,c,d,e){function f(){for(var b=0;b<a.applications.length;b++){var c=h[a.applications[b].character["class"]];a.applications[b].character["class"]=c.charAt(0).toUpperCase()+c.slice(1)}}try{(adsbygoogle=window.adsbygoogle||[]).push({})}catch(g){}var h=["placeholder","warrior","paladin","hunter","rogue","priest","death knight","shaman","mage","warlock","monk","druid"];a.loading=!0,e.getApplications().then(function(b){a.loading=!1,a.applications=b.applications,console.log(a.applications),f()},function(b){a.loading=!1,console.log(b),Materialize.toast("Seems something broke. Try again in a few...")})}]),angular.module("BossCollection.controllers").controller("forumsController",["$scope","$location","$http","userLoginSrvc","$rootScope",function(a,b,c,d,e){a.user.name=d.getUser(),void 0==a.user.name&&b.path("/")}]),angular.module("BossCollection.controllers").controller("homeController",["$scope","$location","$http","$timeout",function(a,b,c,d){try{(adsbygoogle=window.adsbygoogle||[]).push({})}catch(e){}$(".parallax").parallax();var f=[{selector:"#staggered-test",offset:50,callback:'Materialize.toast("This is our ScrollFire Demo!", 1500 )'},{selector:"#staggered-test",offset:205,callback:'Materialize.toast("Please continue scrolling!", 1500 )'},{selector:"#staggered-test",offset:400,callback:'Materialize.showStaggeredList("#staggered-test")'},{selector:"#image-test",offset:500,callback:'Materialize.fadeInImage("#image-test")'}];Materialize.scrollFire(f)}]),angular.module("BossCollection.controllers").controller("navbar",["$scope","$location","$http","userLoginSrvc","$rootScope",function(a,b,c,d,e){console.log("Working?"),a.user={},a.user.name=d.getUser(),a.loggedIn=!1,e.$on("loggedin",function(b,c){console.log(c),c.name?a.user.name=c.name:a.user.name=d.getUser(),a.loggedIn=c.loggedIn}),a.logout=function(){d.logout().then(function(a){},function(a){console.log(a)})},a.areWeLoggedIn=function(){d.currentlyLoggedIn().then(function(b){console.log(b),a.loggedIn=b})},a.areWeLoggedIn()}]),angular.module("BossCollection.controllers").controller("strategyRoomController",["$scope",function(a){}]),angular.module("BossCollection.controllers").controller("bossStrategyController",["$scope","bossStrats","socketProvider","$routeParams",function(a,b,c,d){function e(){for(var b in a.raidToDisplay)a.raidToDisplay[b].isSelected=!1}function f(){document.getElementById("sideNavID").style.height=window.outerHeight/2+"px"}function g(a){return/(?:https?:\/\/|www\.|m\.|^)youtu(?:be\.com\/watch\?(?:.*?&(?:amp;)?)?v=|\.be\/)([\w‌​\-]+)(?:&(?:amp;)?[\w\?=]*)?/.test(a)}a.highmaulBossSelected=!1,a.brfBossSelected=!1,a.hfcBossSelected=!1,$(".modal-trigger").leanModal();try{(adsbygoogle=window.adsbygoogle||[]).push({})}catch(h){console.log("Google broke again")}var i=d.raid;a.highmaul="hm",a.brf="brf",a.hfc="hfc",a.bossInfo={},a.loadChat=!1,a.difficultySelected="",a.currentEmbedUrl="",a.addNewBoss=!1,a.currentRaid={},a.raidToDisplay={},a.name="",a.url="",a.init=function(){f(),b.getStrats(i).then(function(b){a.raidToDisplay=b.bosses,a.raidData=b,e()})},a.addVideo=function(b,c,d){a.currentBoss=b,a.currentDifficulty=c,a.currentRaid=d},a.saveNewBossInfo=function(c,d,e,f){if(console.log(e),g(d)){var h=d.split("&");h=h[0].split("="),d=h[1],"heroic"==f?e.heroic.videos[e.heroic.videos.length]={name:c,url:d}:"mythic"==f&&(e.mythic.videos[e.mythic.videos.length]={name:c,url:d}),a.raidData.bosses=a.raidToDisplay,console.log(a.raidData),b.saveStrats(a.raidData,d),a.addNewBoss=!1,a.name="",a.url="",a.addNewBoss=!a.addNewBoss}else $("#urlInput").popover("show")},a.changeBossInfo=function(b,c){b.isSelected=!b.isSelected,a.bossSelected=b.name,a.addNewBoss=!1},a.changeDifficulty=function(a,b){a.difficultySelected=b,"- Heroic"==b?(a.heroic.isSelected=!a.heroic.isSelected,a.mythic.isSelected=!1):(a.mythic.isSelected=!a.mythic.isSelected,a.heroic.isSelected=!1)},a.setUrl=function(b){a.currentEmbedUrl=b},a.open=function(b){a.setUrl(b),console.log(b),$("#bossVideo").openModal()},a.init()}]),angular.module("BossCollection.controllers").controller("bossStrategyController",["$scope","bossStrats","$modal","socketProvider","$routeParams",function(a,b,c,d,e){function f(){for(var b in a.raidToDisplay)a.raidToDisplay[b].isSelected=!1}function g(){document.getElementById("sideNavID").style.height=window.outerHeight/2+"px"}function h(a){return/(?:https?:\/\/|www\.|m\.|^)youtu(?:be\.com\/watch\?(?:.*?&(?:amp;)?)?v=|\.be\/)([\w‌​\-]+)(?:&(?:amp;)?[\w\?=]*)?/.test(a)}a.highmaulBossSelected=!1,a.brfBossSelected=!1,a.hfcBossSelected=!1;try{(adsbygoogle=window.adsbygoogle||[]).push({})}catch(i){console.log("Google broke again")}var j=e.raid;a.highmaul="hm",a.brf="brf",a.hfc="hfc",a.bossInfo={},a.loadChat=!1,a.difficultySelected="",a.currentEmbedUrl="",a.addNewBoss=!1,a.currentRaid={},a.raidToDisplay={},a.name="",a.url="",a.init=function(){g(),b.getStrats(j).then(function(b){a.raidToDisplay=b.bosses,a.raidData=b,f()})},a.addVideo=function(b,c,d){a.currentBoss=b,a.currentDifficulty=c,a.currentRaid=d},a.saveNewBossInfo=function(c,d,e,f){if(console.log(e),h(d)){var g=d.split("&");g=g[0].split("="),d=g[1],"heroic"==f?e.heroic.videos[e.heroic.videos.length]={name:c,url:d}:"mythic"==f&&(e.mythic.videos[e.mythic.videos.length]={name:c,url:d}),a.raidData.bosses=a.raidToDisplay,console.log(a.raidData),b.saveStrats(a.raidData,d),a.addNewBoss=!1,a.name="",a.url="",a.addNewBoss=!a.addNewBoss}else $("#urlInput").popover("show")},a.changeBossInfo=function(b,c){b.isSelected=!b.isSelected,a.bossSelected=b.name,a.addNewBoss=!1},a.changeDifficulty=function(a,b){a.difficultySelected=b,"- Heroic"==b?(a.heroic.isSelected=!a.heroic.isSelected,a.mythic.isSelected=!1):(a.mythic.isSelected=!a.mythic.isSelected,a.heroic.isSelected=!1)},a.setUrl=function(b){a.currentEmbedUrl=b},a.open=function(b){a.setUrl(b),console.log(b);c.open({templateUrl:"videoModal",controller:"videoController",size:"lg",windowClass:"videoModal",resolve:{currentUrl:function(){return a.currentEmbedUrl}}})},a.init()}]),angular.module("BossCollection.controllers").controller("videoController",["$scope","currentUrl","$modalInstance",function(a,b,c){a.url=b,a.getIframeSrc=function(){return"https://www.youtube.com/embed/"+a.url},a.close=function(){c.dismiss("cancel")},a.embedUrl=a.url}]),angular.module("BossCollection.controllers").controller("rosterController",["$scope","filterFilter","socketProvider","guildServices","$http","$cookies","$location",function(a,b,c,d,e,f,g){function h(){var b=f.getObject("ranksList");b&&(a.raiderRanks=b.raiderRanks,a.trialRanks=b.trialRanks,a.guild=b.guild,a.realm=b.realm)}a.currentRosterDropdown=!0,a.applicantsDropdown=!1;var i=["placeholder","warrior","paladin","hunter","rogue","priest","death knight","shaman","mage","warlock","monk","druid"];a.raiders=[],a.trials=[],a.trialRanks=[9],a.raiderRanks=[0,2,6],a.guild="mkdir bosscollection",a.realm="zul'jin",a.loading=!0,a.genders=["Male","Female"],h(),$("ul.tabs").tabs(),a.getMembers=function(){a.raiders=[],a.trials=[],a.loading=!0,d.getGuild(a.realm,a.guild).then(function(b){console.log(b),a.loading=!1,k(b)},function(b){a.loading=!1,console.log(b)})},a.getUser=function(){e({method:"POST",url:"/getUser"}).success(function(a){console.log(a)})},a.openArmoryProfile=function(a,b){var c="http://us.battle.net/wow/en/character/"+b+"/"+a+"/simple";window.open(c)},a.saveRanksList=function(){var b={guild:a.guild,realm:a.realm,trialRanks:a.trialRanks,raiderRanks:a.raiderRanks};f.putObject("ranksList",b)};var j=function(b,c,d){try{var e={name:b.character.name,"class":d.charAt(0).toUpperCase()+d.slice(1),rank:c,gender:a.genders[b.character.gender],race:b.character.race,spec:b.character.spec.name,achievementPoints:b.character.achievementPoints,avatar:"http://us.battle.net/static-render/us/"+b.character.thumbnail};return e}catch(f){console.log(b)}},k=function(b){for(var c=0;c<b.length;c++){var d=b[c].rank,e=_.find(a.raiderRanks,function(a){return d==a}),f=_.find(a.trialRanks,function(a){return d==a}),g=i[b[c].character["class"]];e&&a.raiders.push(j(b[c],d,g)),f&&a.trials.push(j(b[c],d,g))}a.raiders.sort(function(a,b){return a.rank-b.rank})};a.lowLvlTrials=[],a.getMembers()}]),angular.module("BossCollection.directives",[]).directive("bossstrategies",[function(){return{restrict:"E",templateUrl:"bossStrategy",controller:"bossStrategyController",link:function(a,b,c){}}}]),angular.module("BossCollection.filters",[]).filter("interpolate",function(a){return function(b){return String(b).replace(/\%VERSION\%/gm,a)}}),angular.module("BossCollection.services",[]).factory("bossStrats",["socketProvider","$resource","$q",function(a,b,c){var d=b("/api/bossStrats",{},{update:{method:"PUT"}}),e={getStrats:function(a){var b=c.defer();console.log("Request Boss Info");var e={name:a};return d.save(e).$promise.then(function(a){console.log("Result: "),console.log(a),b.resolve(a.result)}),b.promise},saveStrats:function(a,b){console.log("Saving info now");var c={raidData:a,url:b};c=angular.toJson(c),console.log(c),d.data=c,d.update(c,function(a){console.log("Result: "+a)})}};return e}]),angular.module("BossCollection.services").factory("guildServices",["$http","$q","$resource",function(a,b,c){var d="https://us.api.battle.net/wow/guild/",e="?fields=members&locale=en_US&apikey=fqvadba9c8auw7brtdr72vv7hfntbx7d",f=c("/api/applicationSubmission",{},{}),g=c("/api/getApplications",{},{}),h={getApplications:function(){var a=b.defer();return g.get().$promise.then(function(b){a.resolve(b)},function(b){a.reject(b)}),a.promise},validateCharacterName:function(a,d){var e=b.defer(),f="https://us.api.battle.net/wow/character/"+d+"/"+a+"?locale=en_US&apikey=fqvadba9c8auw7brtdr72vv7hfntbx7d",g=c(f,{},{});return g.get().$promise.then(function(a){e.resolve(a)},function(a){e.reject("Character not found")}),e.promise},getGuild:function(c,f){var g=b.defer();if(""!=c&&""!=f)var h=d+encodeURIComponent(c)+"/"+encodeURIComponent(f)+e;return a({method:"GET",url:h}).then(function(a){g.resolve(a.data.members)}),g.promise},submitApplication:function(a){var d=b.defer(),e="https://us.api.battle.net/wow/character/"+a.realm.name+"/"+a.character.name+"?fields=talents&locale=en_US&apikey=fqvadba9c8auw7brtdr72vv7hfntbx7d",g=c(e,{},{});return g.get().$promise.then(function(a){return a},function(a){d.reject("Character not found")}).then(function(b){a.character.specs=b.talents,f.save({newApplicant:a}).$promise.then(function(a){d.resolve(a)},function(a){d.reject(a)})}),d.promise}};return h}]),angular.module("BossCollection.services").factory("realmServices",["$http","$q",function(a,b){function c(){}var d="https://us.api.battle.net/wow/realm/status?locale=en_US&apikey=fqvadba9c8auw7brtdr72vv7hfntbx7d",e=[];c();var f={getRealms:function(){var c=b.defer();return 0==e.length?a({method:"GET",url:d}).success(function(a){e=a.realms,c.resolve(e),e=e}):c.resolve(e),c.promise}};return f}]),angular.module("BossCollection.services").factory("socketProvider",[function(){var a=io("http://bosscollection.net:4001");return a}]),angular.module("BossCollection.services").factory("userLoginSrvc",["$resource","$q","$location","$cookies","$rootScope",function(a,b,c,d,e){var f=a("/auth/signup",{},{}),g=a("/auth/login",{},{}),h=a("/auth/logout",{},{}),i=a("/auth/loggedin",{},{}),j=a("/auth/updateAccount",{},{}),k=a("/auth/currentUser",{},{}),l={updateAccount:function(a){var c=b.defer();return j.save(a).$promise.then(function(a){c.resolve(a)},function(a){console.log(a),c.reject(a.data)}),c.promise},getUser:function(){var a=b.defer();return k.get().$promise.then(function(b){console.log(b),a.resolve(b)}),a.promise},currentlyLoggedIn:function(){var a=b.defer(),c=!1;return i.save({}).$promise.then(function(b){1==b.loggedIn?(d.put("name",b.user.name),c=!0,e.$broadcast("loggedin",{name:b.user.name,loggedIn:!0})):c=!1,console.log(b),a.resolve(c)},function(b){console.log(b),a.reject(b)}),a.promise},logout:function(){var a=b.defer();return h.save({}).$promise.then(function(a){1==a.loggedOut&&e.$broadcast("loggedin",{loggedIn:!1}),c.path("/")},function(){console.log("WTF, delete cookies anyways..."),d.remove("name"),d.remove("password"),e.$broadcast("loggedin",{loggedIn:!1}),c.path("/")}),a.promise},registerNewUser:function(a){var d=b.defer();return console.log("Register new user"),f.save(a).$promise.then(function(a){console.log("Registration successfull. Redirecting to login page"),console.log(a),c.path("/auth/login")},function(a){console.log(a.data),d.reject(a.data)}),d.promise},login:function(a){var f=b.defer();return g.save(a).$promise.then(function(b){d.put("name",a.name),e.$broadcast("loggedin",{name:a.name,loggedIn:!0}),c.path("/")},function(a){f.reject(a.data)}),f.promise}};return l}]);