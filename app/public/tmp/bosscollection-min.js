"use strict";angular.module("BossCollection",["BossCollection.controllers","BossCollection.services","BossCollection.directives","BossCollection.filters","BossCollection.forums","BossCollection.attendance","ngRoute","ngResource","btford.socket-io","ngCookies","ngMaterial"]).config(["$routeProvider","$locationProvider","$httpProvider","$sceDelegateProvider","$mdThemingProvider",function(e,t,n,o,r){r.theme("default").primaryPalette("deep-orange",{"default":"A700"}).accentPalette("grey",{"default":"900"}),e.when("/",{templateUrl:"home",controller:"homeController"}).when("/strategyRoom/:raid",{templateUrl:"strategyRoom",controller:"strategyRoomController"}).when("/roster",{templateUrl:"roster",controller:"rosterController"}).when("/auth/signup",{templateUrl:"signup",controller:"signupController"}).when("/auth/updateAccount",{templateUrl:"editAccount",controller:"editAccountController"}).when("/auth/application",{templateUrl:"application",controller:"applicationController"}).when("/reviewApplications",{templateUrl:"reviewApplications",controller:"applicationsReviewController"}).when("/createGuild",{templateUrl:"createGuild",controller:"createGuildController"}).when("/joinGuild",{templateUrl:"joinGuild",controller:"joinGuildController"}).when("/manageMembers",{templateUrl:"manageMembers",controller:"manageMembersController"}).otherwise({redirectTo:"/"}),t.hashPrefix("!"),o.resourceUrlWhitelist(["self","https://www.youtube.com/**","https://pagead2.googlesyndication.com"]),t.html5Mode(!0)}]),angular.module("BossCollection.forums",["ngRoute"]).config(["$routeProvider",function(e){e.when("/forum",{templateUrl:"forum",controller:"forumController"}).when("/forum/:forumID",{templateUrl:"thread",controller:"threadController"})}]),angular.module("BossCollection.attendance",["ngRoute"]).config(["$routeProvider",function(e){e.when("/attendanceStatistics",{templateUrl:"attendanceStats",controller:"attendanceStatsCtrl"}).when("/whosOut",{templateUrl:"absenceSubmissions",controller:"absenceSubmissionsController"}).when("/auth/absence",{templateUrl:"absence",controller:"absenceReportController as ctrl"})}]),angular.module("BossCollection.forums").controller("dialogController",["$scope","$location","siteServices","forumService","$mdBottomSheet","$mdDialog","data","userLoginSrvc",function(e,t,n,o,r,i,a,s){e.object={},e.loading=!1,e.replying=!1,e.comment="",e.commentToDelete,e.orderBy="dateCreated",e.init=function(){a?e.object=a:e.object={},s.getUser().then(function(t){e.user=t})},e.cancel=function(){i.cancel()},e.orderByDateCreated=function(){e.orderBy="dateCreated"},e.orderByDateCreatedReversed=function(){e.orderBy="-dateCreated"},e.cancelComment=function(){e.replying=!1},e.cancelCommentEdit=function(e){e.editing=!1},e.saveCommentEdit=function(t){o.editComment(t).then(function(n){e.cancelCommentEdit(t)})},e.confirmDelete=function(t){e.commentToDelete=t,e.confirmDeleteBool=!0},e.deleteComment=function(){o.deleteComment(e.commentToDelete).then(function(t){e.refreshComments()})["catch"](function(e){})["finally"](function(){e.loading=!1,e.confirmDeleteBool=!1})},e.refreshComments=function(){o.getComments(e.object._id).then(function(t){e.object.comments=t.comments})["catch"](function(e){})["finally"](function(){e.loading=!1})},e.cancelCommentDelete=function(){e.commentToDelete={},e.confirmDeleteBool=!1},e.saveComment=function(){var t={message:e.object.newComment,threadId:e.object._id};o.createComment(t).then(function(t){e.object.newComment="",e.object.comments.push(t.comment),e.cancelComment()})},e.openCommentBox=function(){e.replying=!0},e.close=function(){i.hide(e.object)},e.deleteCategory=function(){o.deleteCategory(e.object).then(function(t){e.close(t)})},e.deleteForum=function(){o.deleteForum(e.object).then(function(t){e.close(t)})},e.saveCategory=function(){e.loading=!1,e.object._id?o.editCategory(e.object).then(function(t){e.close(t)})["catch"](function(e){})["finally"](function(){e.loading=!1}):o.createNewCategory({name:e.object.name}).then(function(t){e.close(t)})["catch"](function(e){})["finally"](function(){e.loading=!1})},e.saveThread=function(){var t;e.object._id?(t=e.object,o.editThread(t).then(function(t){e.close(t)})["catch"](function(e){})["finally"](function(){e.loading=!1})):(t={name:e.object.title,forumId:e.object.forum._id,message:e.object.message},o.createThread(t).then(function(t){e.close(t)})["catch"](function(e){})["finally"](function(){e.loading=!1}))},e.formatDate=function(e){var t=moment.utc(e).toDate();return moment(t).format("dddd, MMM D hh:mm")},e.saveForum=function(){if(e.loading=!0,e.object._id){var t=e.object;o.editForum(t).then(function(t){e.close(t)})["catch"](function(e){})["finally"](function(){e.loading=!1})}else{var t={name:e.object.name,categoryId:e.object.object.categoryId};o.createNewForum(t).then(function(t){e.close(t)})["catch"](function(t){e.loading=!1})["finally"](function(){e.loading=!1})}},e.init()}]),angular.module("BossCollection.forums").controller("forumController",["$scope","$location","siteServices","forumService","$mdBottomSheet","$mdDialog","$window",function(e,t,n,o,r,i,a){console.log("Forum Controller loaded"),n.updateTitle("Forums"),e.testListCount=[],e.loading=!1;for(var s=0;5>s;s++)e.testListCount.push(s);e.markdown="",e.init=function(){e.savedForums=o.getForumCountsLocal(),e.getForums()},e.getForums=function(){return e.loading=!0,o.getForums().then(function(t){void 0==e.savedForums&&(e.savedForums=t,o.saveForumCounts(t)),e.loading=!1,e.forums=t})["catch"](function(t){e.loading=!1,console.log(t)})},e.newCategory=function(){e.category={},o.openBottomSheet("category").then(function(t){o.removeLocalForums(),e.getForums()}).then(function(){o.cancel()})["catch"](function(e){})},e.editCategory=function(t){o.openBottomSheet("category",t).then(function(t){o.removeLocalForums(),e.getForums()})["catch"](function(e){})},e.deleteCategory=function(t){o.confirmDelete().then(function(e){return e?(console.log("Deleting the category"),o.deleteCategory(t)):void 0}).then(function(t){o.removeLocalForums(),e.getForums()})},e.createForum=function(t){var n=t._id;o.openBottomSheet("forumEdit",{object:{categoryId:n}}).then(function(t){o.removeLocalForums(),e.getForums()})["catch"](function(e){})},e.isRead=function(t,n){var o,r=_.find(e.savedForums.categories,function(e){return e._id==n._id});return void 0!=r&&(o=_.find(r.forums,function(e){return e._id==t._id})),void 0==o||o.threadCount!=t.threadCount?"unread":"read"},e.editForum=function(t){o.openBottomSheet("forumEdit",t).then(function(t){o.removeLocalForums(),e.getForums()})},e.deleteForum=function(t){o.confirmDelete().then(function(e){return e?(console.log("Deleting the forum"),o.deleteForum(t)):void 0}).then(function(t){o.removeLocalForums(),e.getForums()})},e.goToForum=function(n){e.updateForumViewed(n),o.setForum(n),t.url("/forum/"+n._id)},e.updateForumViewed=function(t){var n,r;_.find(e.savedForums.categories,function(e,o){e._id==t.categoryId&&(n=o,_.find(e.forums,function(e,n){e._id==t._id&&(r=n)}),0==e.forums.length&&e.forums.push(t))}),e.savedForums.categories[n].forums[r]=t,o.saveForumCounts(e.savedForums)},e.init()}]),angular.module("BossCollection.forums").service("forumService",["$location","$mdDialog","$q","$routeParams","siteServices","$mdMedia","$rootScope","$resource","$cookies",function(e,t,n,o,r,i,a,s,c){function l(e){var t=n.defer(),o={category:e};return P.save(o).$promise.then(function(e){t.resolve(e)},function(e){t.reject(e)})["finally"](function(){}),t.promise}function u(e){var t=n.defer(),o={category:e};return G.save(o).$promise.then(function(e){t.resolve(e.category)}),t.promise}function d(e){var t=n.defer(),o={category:e};return E.save(o).$promise.then(function(e){t.resolve(e.category)},function(e){t.reject(e)})["finally"](function(){}),t.resolve(e),t.promise}function f(e){I=e}function m(e){var t=n.defer();return g().then(function(n){var o;_(n.categories).forEach(function(t){_.find(t.forums,function(t){t._id==e&&(o=t)})}),t.resolve(o)},function(e){t.reject(e)})["finally"](function(){}),t.promise}function g(){var e=n.defer();return N?e.resolve(N):H.save({}).$promise.then(function(t){N=t.forums,e.resolve(t.forums)},function(t){e.reject(t)}),e.promise}function h(){N=void 0}function p(e){var t=n.defer(),o={forum:e};return x.save(o).$promise.then(function(e){t.resolve(e)})["catch"](function(e){t.reject(e)})["finally"](function(){}),t.promise}function v(e){var t=n.defer();return q.save({forum:e}).$promise.then(function(e){t.resolve(e)})["catch"](function(e){t.reject(e)}),t.promise}function b(e){localStorage.setItem("forums",angular.toJson(e))}function w(){return angular.fromJson(localStorage.forums)}function y(e){var t=n.defer();return O.save({forum:e}).$promise.then(function(e){t.resolve(e)})["catch"](function(e){t.reject(e)})["finally"](function(){}),t.promise}function C(){var e=n.defer();return I?e.resolve(I):m(o.forumID).then(function(t){I=t,e.resolve(t)}),e.promise}function S(e){localStorage.setItem("threads",angular.toJson(e))}function $(){return angular.fromJson(localStorage.threads)}function B(e){var t=n.defer(),o={forumId:e};return J.save(o).$promise.then(function(e){t.resolve(e.threads)}),t.promise}function M(e){var t=n.defer(),o={thread:e};W.save(o).$promise.then(function(e){t.resolve(e)})["catch"](function(e){t.reject(e)})["finally"](function(){})}function T(e){var t=n.defer();return z.save({thread:e}).$promise.then(function(e){t.resolve(e)})["catch"](function(e){t.reject(e)})["finally"](function(){}),t.promise}function D(e){var t=n.defer(),o={thread:e};return V.save(o).$promise.then(function(e){t.resolve(e.thread)}),t.promise}function k(e){var t=n.defer();return X.save({comment:e}).$promise.then(function(e){t.resolve(e)})["catch"](function(e){t.reject(e)})["finally"](function(){}),t.promise}function L(e){var t=n.defer();return Q.save({comment:e}).$promise.then(function(e){t.resolve(e)})["catch"](function(e){t.reject(e)})["finally"](function(){}),t.promise}function A(e){var t=n.defer(),o={comment:e};return Y.save(o).$promise.then(function(e){t.resolve(e)},function(e){t.reject(e)}),t.promise}function F(e){var t=n.defer(),o={threadId:e};return K.save(o).$promise.then(function(e){t.resolve(e)},function(e){t.reject(e)}),t.promise}function U(e,o){var r=n.defer(),i=t.confirm().title("Are you sure you want to delete this?").textContent("This is irreversable once you click Yes!").ariaLabel("Confirm Delete").targetEvent(e).ok("Delete").cancel("Nevermind");return t.show(i).then(function(){r.resolve(!0)},function(e){r.reject(!1)}),r.promise}function j(e,o){var r=n.defer(),a=i("xs")||i("sm");(i("sm")||i("xs"))&&a;return t.show({templateUrl:e,controller:"dialogController",parent:angular.element(document.body),clickOutsideToClose:!1,locals:{data:o},fullscreen:!0}).then(function(e){r.resolve(e)},function(){r.reject()}),r.promise}function R(){t.hide()}var I,N,G=s("/forum/createCategory",{},{}),E=s("/forum/editCategory",{},{}),P=s("/forum/deleteCategory",{},{}),H=s("/forum/getCategories",{},{}),x=s("/forum/deleteForum",{},{}),O=s("/forum/editForum",{},{}),q=s("/forum/createForum",{},{}),V=s("/forum/createThread",{},{}),J=s("/forum/getThreads",{},{}),W=s("/forum/deleteThread",{},{}),z=s("/forum/editThread"),Y=s("/forum/createComment",{},{}),K=s("/forum/getComments",{},{}),Q=s("/forum/editComment",{},{}),X=s("/forum/deleteComment",{},{});return{setForum:f,confirmDelete:U,openBottomSheet:j,createNewCategory:u,deleteCategory:l,editCategory:d,editForum:y,createNewForum:v,deleteForum:p,cancel:R,getForums:g,removeLocalForums:h,getThreads:B,getCurrentForum:C,deleteThread:M,editThread:T,createThread:D,deleteComment:k,editComment:L,createComment:A,getComments:F,saveForumCounts:b,getForumCountsLocal:w,saveThreadCounts:S,getThreadCountsLocal:$}}]),angular.module("BossCollection.attendance").controller("absenceModalController",["$scope","absenceService","$mdDialog","data",function(e,t,n,o){e.init=function(){o?(e.absence=o,e.absence.date=new Date(e.absence.date)):e.absence={}},e.save=function(){t.saveAbsence(e.absence).then(function(t){e.close(t)}).fail(function(e){})["finally"](function(){})},e.cancel=function(){n.cancel()},e.close=function(){n.hide(e.object)},e.init()}]),angular.module("BossCollection.attendance").factory("absenceService",["$resource","$q","$location","$cookies","$rootScope","siteServices","$mdMedia","$mdDialog",function(e,t,n,o,r,i,a,s){var c=e("/api/absence/absence",{},{}),l=e("/api/absence/absenceByDate",{},{}),u=e("/api/absence/absenceHistory",{},{}),d=e("/api/absence/deleteAbsence"),f=e("/api/absence/saveAbsence"),m={submitNewAbsence:function(e){var n=t.defer();return i.startLoading(),c.save(e).$promise.then(function(e){n.resolve(e)},function(e){console.log(e),n.reject(e.data)})["finally"](function(){i.loadingFinished()}),n.promise},getAbsenceHistory:function(e){var n=t.defer();return i.startLoading(),u.save(e).$promise.then(function(e){n.resolve(e)},function(e){console.log(e),n.reject(e.data)})["finally"](function(){i.loadingFinished()}),n.promise},openEditModal:function(e,n){var o=t.defer(),r=a("xs")||a("sm");(a("sm")||a("xs"))&&r;return s.show({templateUrl:e,controller:"absenceModalController",parent:angular.element(document.body),clickOutsideToClose:!1,locals:{data:n},fullscreen:!0}).then(function(e){o.resolve(e)},function(){o.reject()}),o.promise},saveAbsence:function(e){var n=t.defer(),o={absence:e};return f.save(o).$promise.then(function(e){n.resolve(e)},function(e){console.log(e),n.reject(e.data)})["finally"](function(){i.loadingFinished()}),n.promise},deleteAbsence:function(e){var n=t.defer(),o={absence:e};return d.save(o).$promise.then(function(e){n.resolve(e)},function(e){console.log(e),n.reject(e.data)})["finally"](function(){i.loadingFinished()}),n.promise},getAbsences:function(){var e=t.defer();return c.get().$promise.then(function(t){e.resolve(t)},function(t){console.log(t),e.reject(t.data)})["finally"](function(){i.loadingFinished()}),e.promise},getAbsencesByDate:function(e){var n=t.defer();return l.save({date:e}).$promise.then(function(e){n.resolve(e)},function(e){console.log(e),n.reject(e.data)})["finally"](function(){i.loadingFinished()}),n.promise}};return m}]),angular.module("BossCollection.forums").controller("threadController",["$scope","$location","siteServices","forumService","$mdBottomSheet","$mdDialog","$window","$filter",function(e,t,n,o,r,i,a,s){function c(){self.listStyle.height=a.innerHeight-312+"px",e.$root.$$phase||e.$digest()}function l(){e.threads=s("filter")(e.masterThread,e.threadSearch),e.threads=s("orderBy")(e.threads,e.orderBy),e.threadRepeat&&(e.threadRepeat.numLoaded=e.threads.length-1)}console.log("Thread Controller Loaded"),e.forum={},e.loading=!1,e.orderBy="dateCreated",e.masterThread=[],e.getLength=function(){return e.threads.length},e.getItemAtIndex=function(t){return e.threads[t]},e.init=function(){e.loading=!0,e.savedThreads=o.getThreadCountsLocal(),e.forum=o.getCurrentForum().then(function(t){e.forum=t}).then(function(){return n.updateTitle(e.forum.name+" Forum"),o.getThreads(e.forum)}).then(function(t){e.threads=t,e.masterThread=t,void 0==e.savedThreads&&(e.savedThreads=t,o.saveThreadCounts(t)),e.threadRepeat={toLoad:0,numLoaded:0,threads:e.threads,getItemAtIndex:function(t){return t>this.numLoaded&&t<e.threads.length?(this.fetchMoreThreads(t),null):t<e.threads.length?e.threads[t]:void 0},getLength:function(){return 0==e.threads.length?0:this.numLoaded+1},fetchMoreThreads:function(t){this.toLoad<t&&(this.toLoad+=20,this.numLoaded=this.toLoad,this.numLoaded>e.threads.length&&(this.numLoaded=e.threads.length-1))}},l()})["catch"](function(t){e.loading=!1})["finally"](function(){e.loading=!1})},e.listStyle={height:a.innerHeight-312+"px"},a.addEventListener("resize",c),e.refresh=function(){e.loading=!0,o.getThreads(e.forum).then(function(t){e.loading=!1,e.threads=t,e.masterThread=t,l()})["catch"](function(t){e.loading=!1})},e.deleteThread=function(t){o.confirmDelete().then(function(e){return e?(console.log("Deleting the category"),o.deleteThread(t)):void 0}).then(function(t){e.refresh()})},e.$watch("threadSearch",function(){l()}),e.$watch("orderBy",function(){l()}),e.orderByDateCreated=function(){e.orderBy="dateCreated"},e.orderByDateCreatedReversed=function(){e.orderBy="-dateCreated"},e.openThread=function(t){o.getComments(t._id).then(function(n){t.comments=n.comments,e.updateThreadViewed(t),o.openBottomSheet("threadComments",t)})},e.createThread=function(){o.openBottomSheet("threadEdit",{forum:e.forum}).then(function(t){e.refresh()})},e.editThread=function(e){o.openBottomSheet("threadEdit",e)},e.goBack=function(){window.history.back()},e.isRead=function(t){var n=_.find(e.savedThreads,function(e){return e._id==t._id});return void 0==n||n.commentCount!=t.commentCount?"unread":"read"},e.updateThreadViewed=function(t){var n;_.find(e.savedThreads,function(n,o){n._id==t._id&&(e.savedThreads[o]=t)}),(0==e.savedThreads.length||void 0==n)&&e.savedThreads.push(t),o.saveThreadCounts(e.savedThreads)},e.init()}]),angular.module("BossCollection.attendance").controller("attendanceStatsCtrl",["$scope","$location","userLoginSrvc","absenceService","siteServices","$filter",function(e,t,n,o,r,i){r.updateTitle("Attendance Statistics"),e.absenceHighchartData=[],e.absenceHighchartDrillDownSeries=[],e.late=1,e.absent=6,e.weeksCounted=4,e.raidsPerWeek=3,e.startingDate=moment(),e.init=function(){e.getAbsences(),e.buildHighChart()},e.getAbsences=function(){e.currentlySelected="All absences",e.loading=!0;var t={date:e.startingDate,weeks:e.weeksCounted};o.getAbsenceHistory(t).then(function(t){e.loading=!1,e.absences=t.absences,e.calculateAttendance()},function(t){r.showMessageModal(t.message),e.loading=!1,console.log(t)})},e.calculateAttendance=function(){var t=_.groupBy(e.absences,"user");e.absenceHighchartData=[],e.absenceHighchartDrillDownSeries=[],_(t).forEach(function(t){var n=_.groupBy(t,"type"),o=0,r=0;n.late&&(o=n.late.length||0),n.absent&&(r=n.absent.length||0);var i=e.weeksCounted*e.raidsPerWeek*e.absent,a=e.late/e.absent*e.absent,s=i-o*a-r*e.absent,c=s/i;e.absenceHighchartData.push({name:t[0].user,y:100*c,drilldown:t[0].user});var l=[];_(n.late).forEach(function(t){l.push([t.date,e.late])}),_(n.absent).forEach(function(t){l.push([t.date,e.absent])}),e.absenceHighchartDrillDownSeries.push({name:t[0].user,id:t[0].user,data:l})},this),e.buildHighChart()},e.redrawChart=function(t,n){e.chart.series[0].setData([{name:"Member",colorByPoint:!0,data:e.absenceHighchartData}]),e.chart.drilldown.setData({series:e.absenceHighchartDrillDownSeries})},e.buildHighChart=function(){e.chart=new Highcharts.Chart({chart:{type:"column",renderTo:"container"},title:{text:"Member attendance rates"},subtitle:{text:"Click the columns to view dates missed."},xAxis:{type:"category"},yAxis:{title:{text:"Percent attendance"}},legend:{enabled:!1},plotOptions:{series:{borderWidth:0,dataLabels:{enabled:!0,format:"{point.y:.1f}%"}}},series:[{name:"Member",colorByPoint:!0,data:e.absenceHighchartData}],drilldown:{series:e.absenceHighchartDrillDownSeries}})},e.init()}]),angular.module("BossCollection.attendance").controller("absenceReportController",["$scope","$location","userLoginSrvc","absenceService","siteServices","$filter","guildServices",function(e,t,n,o,r,i,a){var s=(moment().day(),this);e.newAbsence={},e.absences={},e.loading=!1,e.typePicked=!1,e.today=moment(),e.dayDesired,e.currentlySelected=moment().format("dddd - Do"),s.selectedUser={},e.toolbar={isOpen:!1,direction:"right"},e.currentlySelected="Today",e.isToolSetOpen=!1,e.init=function(){r.updateTitle("Report Absence"),e.user.rank<3?s.selectedUser=e.user:e.getGuildUsers()},e.getGuildUsers=function(){e.loading=!0,a.getGuildMembers(e.user.guild.name).then(function(t){e.users=t})["finally"](function(){e.loading=!1})},e.updateList=function(){e.currentlySelected=moment(e.dayDesired).format("dddd - Do"),e.getAbsencesByDate()},e.formatDate=function(e){return moment.utc(e).format("dddd, MMM D")},e.getAbsences=function(){e.currentlySelected="All absences",e.loading=!0,o.getAbsences().then(function(t){e.loading=!1,e.absences=t.absences},function(t){r.showMessageToast(t),e.loading=!1,console.log(t)})},e.getAbsencesByDate=function(){e.loading=!0,o.getAbsencesByDate(e.dayDesired).then(function(t){e.loading=!1,e.absences=t.absences},function(t){r.showMessageToast(t),e.loading=!1,console.log(t)})},e.filterSearch=function(t){return i("filter")(e.users,t)},e.submitNewAbsence=function(){null==e.newAbsence.date?r.showMessageModal("Must select a date"):null==e.newAbsence.type?r.showMessageModal("Must select a type: Late or Absent"):(e.user.rank<3?s.selectedUser=e.user.name:e.newAbsence.user=s.selectedUser.user,o.submitNewAbsence(e.newAbsence).then(function(e){t.path("/whosOut")},function(e){Materialize.toast(e),console.log(e)}))},e.init()}]),angular.module("BossCollection.attendance").controller("absenceSubmissionsController",["$scope","$location","userLoginSrvc","absenceService","siteServices","$filter",function(e,t,n,o,r,i){moment().day();e.newAbsence={},e.absences={},e.loading=!1,e.typePicked=!1,e.today=moment(),e.dayDesired,e.currentlySelected=moment().format("dddd - Do"),e.viewing=0,e.init=function(){e.getAbsences(),e.toolbar={isOpen:!1,direction:"right"},e.currentlySelected="All Future Absences",e.isToolSetOpen=!1,r.updateTitle("Upcoming Absences")},e.updateList=function(){e.viewing=1,e.currentlySelected=moment(e.dayDesired).format("dddd - Do"),e.getAbsencesByDate()},e.dateHasPassed=function(e){return moment(e.date).isBefore(moment())?!1:!0},e.formatDate=function(e){return moment.utc(e).format("dddd, MMM D")},e.getAbsences=function(){e.currentlySelected="All absences",e.loading=!0,e.viewing=0,o.getAbsences().then(function(t){e.loading=!1,e.absences=t.absences},function(t){r.showMessageModal(t.message),e.loading=!1,console.log(t)})},e.deleteAbsence=function(t){r.confirmDelete().then(function(e){return o.deleteAbsence(t)}).then(function(t){0==e.viewing?e.getAbsences():e.updateList()})["finally"](function(){})},e.editAbsence=function(t){o.openEditModal("editAbsence",t).then(function(t){0==e.viewing?e.getAbsences():e.updateList()})},e.getAbsencesByDate=function(){e.loading=!0,o.getAbsencesByDate(e.dayDesired).then(function(t){e.loading=!1,e.absences=t.absences},function(t){r.showMessageToast(t),e.loading=!1,console.log(t)})},e.submitNewAbsence=function(){null==e.newAbsence.date?r.showMessageModal("Must select a date"):null==e.newAbsence.type?r.showMessageModal("Must select a type: Late or Absent"):o.submitNewAbsence(e.newAbsence).then(function(e){t.path("/whosOut")},function(e){Materialize.toast(e),console.log(e)})},e.init()}]),angular.module("BossCollection.controllers",[]),angular.module("BossCollection.controllers").controller("homeController",["$scope","$location","$http","$timeout","siteServices","$sce",function(e,t,n,o,r,i){r.updateTitle("Home")}]),angular.module("BossCollection.controllers").controller("navbar",["$scope","$location","$http","userLoginSrvc","$rootScope","$mdSidenav","siteServices",function(e,t,n,o,r,i,a){function s(e){return function(){i(e).toggle()}}function c(){o.getUser().then(function(t){t&&(e.user=t,e.loggedIn=!0)},function(t){e.user.name="",e.loggedIn=!1})}var l;e.user={},e.user.name="",e.loggedIn=!1,e.title="",e.init=function(){c()},e.showLoginBottomSheet=function(e){a.showLoadingBottomSheet(e)},e.openMenu=function(e,t){l=t,e(t)},e.goTo=function(n){t.url(n),e.toggle()},e.goToExternal=function(e){window.open(e,"_blank")},r.$on("navbarTitle",function(t,n){e.title=n}),r.$on("loggedin",function(e,t){c()}),e.logout=function(){o.logout().then(function(e){},function(e){console.log(e)})},e.areWeLoggedIn=function(){o.getUser().then(function(t){e.loggedIn=!0})["catch"](function(t){e.loggedIn=!1})},e.openSideBar=function(e){i(e).open()},e.closeSideBar=function(e){i(e).close()},e.toggle=s("left"),e.init()}]),angular.module("BossCollection.controllers").controller("rosterController",["$scope","filterFilter","guildServices","$http","$cookies","$location","siteServices",function(e,t,n,o,r,i,a){function s(){var t=r.getObject("ranksList");t&&(e.raiderRanks=t.raiderRanks,e.trialRanks=t.trialRanks,e.guild=t.guild,e.realm=t.realm)}a.updateTitle("Guild Roster"),e.currentRosterDropdown=!0,e.applicantsDropdown=!1;var c=["placeholder","warrior","paladin","hunter","rogue","priest","death knight","shaman","mage","warlock","monk","druid"];e.raiders=[],e.trials=[],e.trialRanks=[9],e.raiderRanks=[0,2,6],e.guild="mkdir bosscollection",e.realm="zul'jin",e.loading=!0,e.genders=["Male","Female"],s(),$("ul.tabs").tabs(),e.getMembers=function(){e.raiders=[],e.trials=[],e.loading=!0,n.getGuild(e.realm,e.guild).then(function(t){console.log(t),e.loading=!1,u(t)},function(t){e.loading=!1,console.log(t)})},e.getUser=function(){o({method:"POST",url:"/getUser"}).success(function(e){console.log(e)})},e.openArmoryProfile=function(e,t){var n="http://us.battle.net/wow/en/character/"+t+"/"+e+"/simple";window.open(n)},e.saveRanksList=function(){var t={guild:e.guild,realm:e.realm,trialRanks:e.trialRanks,raiderRanks:e.raiderRanks};r.putObject("ranksList",t)};var l=function(t,n,o){try{var r={name:t.character.name,"class":o.charAt(0).toUpperCase()+o.slice(1),rank:n,gender:e.genders[t.character.gender],race:t.character.race,spec:t.character.spec.name,achievementPoints:t.character.achievementPoints,avatar:"http://us.battle.net/static-render/us/"+t.character.thumbnail};return r}catch(i){console.log(t)}},u=function(t){for(var n=0;n<t.length;n++){var o=t[n].rank,r=_.find(e.raiderRanks,function(e){return o==e}),i=_.find(e.trialRanks,function(e){return o==e}),a=c[t[n].character["class"]];r&&e.raiders.push(l(t[n],o,a)),i&&e.trials.push(l(t[n],o,a))}e.raiders.sort(function(e,t){return e.rank-t.rank})};e.lowLvlTrials=[],e.getMembers()}]),angular.module("BossCollection.controllers").controller("editAccountController",["$scope","$location","$http","userLoginSrvc","siteServices","guildServices",function(e,t,n,o,r,i){r.updateTitle("Account"),e.leaveGuild=function(){var t=e.user.guild.name;i.leaveGuild(t).then(function(t){e.user=o.updateUser()})},e.updateAccount=function(){console.log("Updating account"),o.updateAccount(e.user).then(function(t){e.user=o.updateUser(),r.showMessageToast("User updated")},function(e){r.showMessageModal(e)})}}]),angular.module("BossCollection.controllers").controller("loginController",["$scope","$location","$http","userLoginSrvc","siteServices","$mdBottomSheet","$timeout",function(e,t,n,o,r,i,a){e.user={},e.user.name="",e.loading=!1,"/auth/login"==t.url()&&r.updateTitle("Login"),console.log("Login Controller"),e.init=function(){},e.resetPassword=function(){e.loading=!0,o.lostPassword(e.user.email).then(function(e){r.showMessageModal("Email has been sent. Refer to your email for your temporary password.")})["catch"](function(e){r.showMessageModal(e)})["finally"](function(){e.loading=!1})},e.alreadyLoggedIn=function(){1==o.loggedIn()&&t.path("/")},e.openPasswordResetWindow=function(e){i.show({templateUrl:"resetPassword",controller:"loginController",targetEvent:e,escapeToClose:!1})},e.cancelPasswordReset=function(){i.hide(),a(function(){r.showLoadingBottomSheet()},500)},e.login=function(){o.login(e.user).then(function(e){console.log(e),o.getUser().then(function(){"/auth/application"==t.path()||t.path("/")})},function(e){r.showMessageModal(e),console.log(e)})},e.cancelLogin=function(){r.hideBottomSheet(),t.path("/")}}]),angular.module("BossCollection.controllers").controller("signupController",["$scope","$location","$http","$timeout","userLoginSrvc","siteServices",function(e,t,n,o,r,i){e.user={},e.passwordsMatch=!1,$("#logInModal").closeModal(),e.register=function(){r.registerNewUser(e.user).then(function(e){console.log(e)},function(t){e.passwordsMatch=!0,e.openFromLeft(t),console.log(t)})},e.openFromLeft=function(e){i.showMessageModal(e)}}]),angular.module("BossCollection.controllers").controller("applicationController",["$scope","$location","$http","$timeout","$filter","realmServices","guildServices","userLoginSrvc","siteServices",function(e,t,n,o,r,i,a,s,c){c.updateTitle("Applications"),console.log("Loading application ctrl..."),e.application={},e.validCharacterName=!1,e.charRequirementsIncomplete=!1,e.charRealmError=!1,e.searchingForUser=!1,e.icon="error",e.init=function(){i.getRealms().then(function(t){e.realms=t}).then(function(){return e.loggedIn()})["catch"](function(e){console.log(e)})["finally"](function(){o(function(){c.hideLoadingModal()},500)})},e.filterSearch=function(t){return r("filter")(e.realms,t)},e.loggedIn=function(){s.getUser().then(function(e){})["catch"](function(e){c.showMessageModal("Please log in before attempting to apply."),t.path("/")})["finally"](function(){})},e.validateCharactername=function(t){e.application.realm?(e.validCharacterName=!1,e.searchingForUser=!0,a.validateCharacterName(e.application.characterName,e.application.realm.name).then(function(n){e.validCharacterName=!0,e.icon="check_circle",e.application.character=n,t&&t()},function(t){e.icon="error",c.showMessageToast(t),e.validCharacterName=!1})["finally"](function(){e.searchingForUser=!1})):(e.validCharacterName=!1,t&&t())},e.submitApplication=function(){e.validateCharactername(function(){0==e.validCharacterName?c.showMessageToast("Sorry, we couldn't find your character. Please verify your Realm and Character are correct."):a.submitApplication(e.application).then(function(e){t.path("/reviewApplications")},function(e){c.showMessageToast(e)})})},e.init()}]),angular.module("BossCollection.controllers").controller("applicationsReviewController",["$scope","$location","$http","$timeout","guildServices","siteServices",function(e,t,n,o,r,i){function a(){for(var t=0;t<e.applications.length;t++){var n=s[e.applications[t].character["class"]];e.applications[t].character["class"]=n.charAt(0).toUpperCase()+n.slice(1)}}i.updateTitle("View Applications");var s=["placeholder","warrior","paladin","hunter","rogue","priest","death knight","shaman","mage","warlock","monk","druid"];e.loading=!0,e.openComments=function(e){i.showMessageModal(e,"Comments")},e.goTo=function(e){var t=window.open(e,"_blank");t.focus()},e.buildArmoryUrl=function(t,n){var o="http://us.battle.net/wow/en/character/"+t+"/"+n+"/simple";e.goTo(o)},r.getApplications().then(function(t){e.loading=!1,e.applications=t.applications,console.log(e.applications),a()},function(t){e.loading=!1,console.log(t),i.showMessageToast("Seems something broke. Try again in a few...")})}]),angular.module("BossCollection.controllers").controller("createGuildController",["$scope","$location","$http","$timeout","siteServices","guildServices","userLoginSrvc",function(e,t,n,o,r,i,a){r.updateTitle("Create Guild"),e.guildName="",e.loading=!1,e.joinGuild=function(){e.loading=!0,i.createGuild(e.guildName).then(function(){var e=a.updateUser();r.showMessageModal("Successfully created "+e.guild.name),t.path("/")})["catch"](function(e){r.showMessageModal(e)})["finally"](function(){e.loading=!1})}}]),angular.module("BossCollection.controllers").controller("joinGuildController",["$scope","$location","$http","$timeout","siteServices","guildServices","userLoginSrvc","$filter",function(e,t,n,o,r,i,a,s){e.listOfGuilds=[],e.loading=!1,r.updateTitle("Join Guild"),e.init=function(){e.getGuilds()},e.filterSearch=function(t){return s("filter")(e.listOfGuilds,t)},e.getGuilds=function(){i.getListOfGuilds().then(function(t){e.listOfGuilds=t})},e.joinGuild=function(){e.loading=!0,e.guildName?i.joinGuild(e.guildName.name,e.user.name).then(function(n){r.showMessageModal("Success! You will be able to access the guild services once you've been promoted to member."),a.updateUser(e.user),t.path("/")})["catch"](function(e){r.showMessageModal(e)})["finally"](function(){e.loading=!1}):(r.showMessageToast("Guild doesn't exist"),e.loading=!1)},e.init()}]),angular.module("BossCollection.controllers").controller("manageMembersController",["$scope","$location","$http","$timeout","siteServices","guildServices","userLoginSrvc","$filter",function(e,t,n,o,r,i,a,s){e.guildMembers,e.ranks=["Applicant","Member","Officer","GM"],
e.init=function(){""!=e.user.name?i.getGuildMembers(e.user.guild.name).then(function(t){e.guildMembers=t}):a.getUser().then(function(t){i.getGuildMembers(t.guild.name).then(function(t){e.guildMembers=t})})},e.promote=function(t){3==t.rank?r.showMessageModal("Can't promote any further"):(t.rank++,i.updateRank(e.user.guild.name,t).then(function(){})["catch"](function(e){r.showMessageModal(e)}))},e.demote=function(t){1==t.rank?r.showMessageModal("Can't demote any further. They are effectively kicked at this rank."):(t.rank--,i.updateRank(e.user.guild.name,t).then(function(){})["catch"](function(e){r.showMessageModal(e)}))},e.init(),r.updateTitle("Manage Members")}]),angular.module("BossCollection.controllers").controller("strategyRoomController",["$scope",function(e){}]),angular.module("BossCollection.controllers").controller("bossStrategyController",["$scope","bossStrats","$routeParams",function(e,t,n){function o(){for(var t in e.raidToDisplay)e.raidToDisplay[t].isSelected=!1}function r(){document.getElementById("sideNavID").style.height=window.outerHeight/2+"px"}function i(e){return/(?:https?:\/\/|www\.|m\.|^)youtu(?:be\.com\/watch\?(?:.*?&(?:amp;)?)?v=|\.be\/)([\w‌​\-]+)(?:&(?:amp;)?[\w\?=]*)?/.test(e)}e.highmaulBossSelected=!1,e.brfBossSelected=!1,e.hfcBossSelected=!1,$(".modal-trigger").leanModal();var a=n.raid;e.highmaul="hm",e.brf="brf",e.hfc="hfc",e.bossInfo={},e.loadChat=!1,e.difficultySelected="",e.currentEmbedUrl="",e.addNewBoss=!1,e.currentRaid={},e.raidToDisplay={},e.name="",e.url="",e.init=function(){r(),t.getStrats(a).then(function(t){e.raidToDisplay=t.bosses,e.raidData=t,o()})},e.addVideo=function(t,n,o){e.currentBoss=t,e.currentDifficulty=n,e.currentRaid=o},e.saveNewBossInfo=function(n,o,r,a){if(console.log(r),i(o)){var s=o.split("&");s=s[0].split("="),o=s[1],"heroic"==a?r.heroic.videos[r.heroic.videos.length]={name:n,url:o}:"mythic"==a&&(r.mythic.videos[r.mythic.videos.length]={name:n,url:o}),e.raidData.bosses=e.raidToDisplay,console.log(e.raidData),t.saveStrats(e.raidData,o),e.addNewBoss=!1,e.name="",e.url="",e.addNewBoss=!e.addNewBoss}else $("#urlInput").popover("show")},e.changeBossInfo=function(t,n){t.isSelected=!t.isSelected,e.bossSelected=t.name,e.addNewBoss=!1},e.changeDifficulty=function(e,t){e.difficultySelected=t,"- Heroic"==t?(e.heroic.isSelected=!e.heroic.isSelected,e.mythic.isSelected=!1):(e.mythic.isSelected=!e.mythic.isSelected,e.heroic.isSelected=!1)},e.setUrl=function(t){e.currentEmbedUrl=t},e.open=function(t){e.setUrl(t),console.log(t),$("#bossVideo").openModal()},e.init()}]),angular.module("BossCollection.controllers").controller("bossStrategyController",["$scope","bossStrats","$modal","$routeParams",function(e,t,n,o){function r(){for(var t in e.raidToDisplay)e.raidToDisplay[t].isSelected=!1}function i(){document.getElementById("sideNavID").style.height=window.outerHeight/2+"px"}function a(e){return/(?:https?:\/\/|www\.|m\.|^)youtu(?:be\.com\/watch\?(?:.*?&(?:amp;)?)?v=|\.be\/)([\w‌​\-]+)(?:&(?:amp;)?[\w\?=]*)?/.test(e)}e.highmaulBossSelected=!1,e.brfBossSelected=!1,e.hfcBossSelected=!1;var s=o.raid;e.highmaul="hm",e.brf="brf",e.hfc="hfc",e.bossInfo={},e.loadChat=!1,e.difficultySelected="",e.currentEmbedUrl="",e.addNewBoss=!1,e.currentRaid={},e.raidToDisplay={},e.name="",e.url="",e.init=function(){i(),t.getStrats(s).then(function(t){e.raidToDisplay=t.bosses,e.raidData=t,r()})},e.addVideo=function(t,n,o){e.currentBoss=t,e.currentDifficulty=n,e.currentRaid=o},e.saveNewBossInfo=function(n,o,r,i){if(console.log(r),a(o)){var s=o.split("&");s=s[0].split("="),o=s[1],"heroic"==i?r.heroic.videos[r.heroic.videos.length]={name:n,url:o}:"mythic"==i&&(r.mythic.videos[r.mythic.videos.length]={name:n,url:o}),e.raidData.bosses=e.raidToDisplay,console.log(e.raidData),t.saveStrats(e.raidData,o),e.addNewBoss=!1,e.name="",e.url="",e.addNewBoss=!e.addNewBoss}else $("#urlInput").popover("show")},e.changeBossInfo=function(t,n){t.isSelected=!t.isSelected,e.bossSelected=t.name,e.addNewBoss=!1},e.changeDifficulty=function(e,t){e.difficultySelected=t,"- Heroic"==t?(e.heroic.isSelected=!e.heroic.isSelected,e.mythic.isSelected=!1):(e.mythic.isSelected=!e.mythic.isSelected,e.heroic.isSelected=!1)},e.setUrl=function(t){e.currentEmbedUrl=t},e.open=function(t){e.setUrl(t),console.log(t);n.open({templateUrl:"videoModal",controller:"videoController",size:"lg",windowClass:"videoModal",resolve:{currentUrl:function(){return e.currentEmbedUrl}}})},e.init()}]),angular.module("BossCollection.controllers").controller("videoController",["$scope","currentUrl","$modalInstance",function(e,t,n){e.url=t,e.getIframeSrc=function(){return"https://www.youtube.com/embed/"+e.url},e.close=function(){n.dismiss("cancel")},e.embedUrl=e.url}]),angular.module("BossCollection.directives",[]),angular.module("BossCollection.directives").directive("ad",[function(){return{restrict:"E",template:'<ins class="adsbygoogle"style="display:block;overflow:hidden;"data-ad-client="ca-pub-4895481554192451"data-ad-slot="1814022675"data-ad-format="auto">',link:function(e,t,n){try{(adsbygoogle=window.adsbygoogle||[]).push({})}catch(o){console.log("Add code broke"),console.log(o)}}}}]),angular.module("BossCollection.directives").directive("bossstrategies",[function(){return{restrict:"E",templateUrl:"bossStrategy",controller:"bossStrategyController",link:function(e,t,n){}}}]),angular.module("BossCollection.directives").directive("logIn",[function(){return{restrict:"E",templateUrl:"login",controller:"loginController",link:function(e,t,n){}}}]),angular.module("BossCollection.directives").directive("myEnter",function(){return function(e,t,n){t.bind("keydown keypress",function(t){13===t.which&&(e.$apply(function(){e.$eval(n.myEnter)}),t.preventDefault())})}}),angular.module("BossCollection.directives").directive("displayMarkdown",["$sce",function(e){return{restrict:"E",scope:{markdown:"=markdown"},link:function(t){var n=new showdown.Converter;t.converToHtml=function(){t.html=e.trustAsHtml(n.makeHtml(t.markdown))},t.converToHtml(t.markdown)},templateUrl:"displayMarkdownDirective"}}]),angular.module("BossCollection.directives").directive("inputMarkdown",["$sce",function(e){return{restrict:"E",scope:{input:"=input"},link:function(t){var n=new showdown.Converter;t.markdown=t.input,t.showPreview=!0,t.goToExternal=function(e){window.open(e,"_blank")},t.converToHtml=function(){t.html=e.trustAsHtml(n.makeHtml(t.markdown)),t.input=t.markdown},t.hideShowPreview=function(){t.showPreview=!t.showPreview},t.converToHtml(t.markdown)},templateUrl:"inputField"}}]),angular.module("BossCollection.filters",[]),angular.module("BossCollection.filters").filter("applicants",[function(){return function(e){var t=[];return t=_.filter(e,function(e){return 1==e.rank}),t.length}}]),angular.module("BossCollection.filters").filter("interpolate",function(e){return function(t){return String(t).replace(/\%VERSION\%/gm,e)}}),angular.module("BossCollection.services",[]),angular.module("BossCollection.services").factory("bossStrats",["$resource","$q",function(e,t){var n=e("/api/bossStrats",{},{update:{method:"PUT"}}),o={getStrats:function(e){var o=t.defer();console.log("Request Boss Info");var r={name:e};return n.save(r).$promise.then(function(e){console.log("Result: "),console.log(e),o.resolve(e.result)}),o.promise},saveStrats:function(e,t){console.log("Saving info now");var o={raidData:e,url:t};o=angular.toJson(o),console.log(o),n.data=o,n.update(o,function(e){console.log("Result: "+e)})}};return o}]),angular.module("BossCollection.services").factory("guildServices",["$http","$q","$resource","siteServices","userLoginSrvc",function(e,t,n,o,r){var i="https://us.api.battle.net/wow/guild/",a="?fields=members&locale=en_US&apikey=fqvadba9c8auw7brtdr72vv7hfntbx7d",s=n("/api/applicationSubmission",{},{}),c=n("/api/getApplications",{},{}),l=n("/api/addGuild",{},{}),u=n("/api/updateRank",{},{}),d=(n("/api/changeGuildName",{},{}),n("/api/addMember",{},{})),f=n("/api/removeMember",{},{}),m=n("/api/getGuildMembers",{},{}),g=n("/api/listOfGuilds",{},{}),h={getListOfGuilds:function(){var e=t.defer();return o.startLoading(),g.get().$promise.then(function(t){e.resolve(t.guilds)})["catch"](function(t){e.reject(t.data.message)})["finally"](function(){o.loadingFinished()}),e.promise},updateRank:function(e,n){var r=t.defer();return u.save({guildName:e,member:n}).$promise.then(function(e){r.resolve(e.members)})["catch"](function(e){r.reject(e.data.message)})["finally"](function(){o.loadingFinished()}),r.promise},getGuildMembers:function(e){var n=t.defer();return o.startLoading(),m.save({guildName:e}).$promise.then(function(e){n.resolve(e.members)})["catch"](function(e){n.reject(e.data.message)})["finally"](function(){o.loadingFinished()}),n.promise},createGuild:function(e){var n=t.defer();return l.save({guildName:e}).$promise.then(function(e){n.resolve(e.guild)})["catch"](function(e){n.reject(e.data.message)})["finally"](function(){}),n.promise},joinGuild:function(e,n){var o=t.defer();return d.save({guildName:e,memberName:n}).$promise.then(function(e){o.resolve(e.guild)})["catch"](function(e){o.reject(e.data.message)})["finally"](function(){}),o.promise},leaveGuild:function(e){var n=t.defer();return o.startLoading(),f.save({guildName:e}).$promise.then(function(e){n.resolve(e.user)})["catch"](function(e){n.reject(e.data.message)})["finally"](function(){o.loadingFinished()}),n.promise},getApplications:function(){var e=t.defer();return o.startLoading(),c.get().$promise.then(function(t){e.resolve(t)},function(t){e.reject(t)})["finally"](function(){o.loadingFinished()}),e.promise},validateCharacterName:function(e,o){var r=t.defer(),i="https://us.api.battle.net/wow/character/"+o+"/"+e+"?locale=en_US&apikey=fqvadba9c8auw7brtdr72vv7hfntbx7d",a=n(i,{},{});return a.get().$promise.then(function(e){r.resolve(e)},function(e){r.reject("Character not found")}),r.promise},getGuild:function(n,r){var s=t.defer();if(o.startLoading(),""!=n&&""!=r)var c=i+encodeURIComponent(n)+"/"+encodeURIComponent(r)+a;return e({method:"GET",url:c}).then(function(e){s.resolve(e.data.members)},function(e){s.reject(e)})["finally"](function(){o.loadingFinished()}),s.promise},submitApplication:function(e){var r=t.defer(),i="https://us.api.battle.net/wow/character/"+e.realm.name+"/"+e.character.name+"?fields=talents&locale=en_US&apikey=fqvadba9c8auw7brtdr72vv7hfntbx7d",a=n(i,{},{});return o.startLoading(),a.get().$promise.then(function(e){return e},function(e){r.reject("Character not found")}).then(function(t){e.character.specs=t.talents,s.save({newApplicant:e}).$promise.then(function(e){o.loadingFinished(),r.resolve(e)},function(e){r.reject(e)})})["finally"](function(){o.loadingFinished()}),r.promise}};return h}]),angular.module("BossCollection.services").factory("realmServices",["$http","$q","siteServices",function(e,t,n){var o="https://us.api.battle.net/wow/realm/status?locale=en_US&apikey=fqvadba9c8auw7brtdr72vv7hfntbx7d",r=[],i={getRealms:function(){var i=t.defer();return 0==r.length?e({method:"GET",url:o}).success(function(e){n.hideLoadingModal(),r=e.realms,i.resolve(r),r=r}):(n.hideLoadingModal(),i.resolve(r)),i.promise}};return i}]),angular.module("BossCollection.services").factory("siteServices",["$rootScope","$mdBottomSheet","$mdDialog","$mdToast","$q",function(e,t,n,o,r){function i(){p||(p=!0,h())}function a(){g(),p=!1}function s(t){e.$broadcast("navbarTitle",t)}function c(e){t.show({templateUrl:"logInModal",controller:"loginController",targetEvent:e,escapeToClose:!1})}function l(e,t){var o=r.defer(),i=n.confirm().title("Are you sure you want to delete this?").textContent("This is irreversable once you click Yes!").ariaLabel("Confirm Delete").targetEvent(e).ok("Delete").cancel("Nevermind");return n.show(i).then(function(){o.resolve(!0)},function(e){o.reject(!1)}),o.promise}function u(){t.hide()}function d(){t.hide()}function f(e,t){n.show(n.alert().clickOutsideToClose(!0).title(t).textContent(e).ariaLabel("message popup").ok("Got it!").openFrom({left:-50,width:30,height:80}).closeTo({right:1500}))}function m(e){o.show(o.simple().textContent(e).position("top").hideDelay(4e3))}function g(){0==p||(p=!1,n.hide())}function h(){n.show({templateUrl:"loadingModal",onComplete:function(){p||n.hide()}})}var p=!1;return{startLoading:i,loadingFinished:a,updateTitle:s,showLoadingBottomSheet:c,hideLoadingBottomSheet:u,showMessageModal:f,showMessageToast:m,hideBottomSheet:d,showLoadingModal:h,hideLoadingModal:g,confirmDelete:l}}]),angular.module("BossCollection.services").factory("socketProvider",[function(){}]),angular.module("BossCollection.services").factory("userLoginSrvc",["$resource","$q","$location","$cookies","$rootScope","siteServices",function(e,t,n,o,r,i){function a(){var e=o.get("user"),t=void 0;if(e){var n=e.substring(e.indexOf("{"),e.lastIndexOf("}")+1);t=JSON.parse(n)}return t}function s(e){var t;return g&&g.guild?(t=_.find(g.guild.members,{user:g.name}),g.rank=t.rank,t.rank):e&&e.guild?(t=_.find(g.guild.members,{user:g.name}),t.rank):0}var c=e("/auth/signup",{},{}),l=e("/auth/login",{},{}),u=e("/auth/logout",{},{}),d=(e("/auth/loggedin",{},{}),e("/auth/updateAccount",{},{})),f=e("/auth/currentUser",{},{}),m=e("/auth/lost-password",{},{}),g=null,h={lostPassword:function(e){var n=t.defer();return m.save({email:e}).$promise.then(function(e){n.resolve(e)},function(e){n.reject(e.data.message)}),n.promise},updateAccount:function(e){var n=t.defer();return i.startLoading(),d.save(e).$promise.then(function(e){n.resolve(e)},function(e){console.log(e),n.reject(e.data.message)})["finally"](function(){i.loadingFinished()}),n.promise},updateUser:function(){return g=a(),g&&g.guild&&s(g),r.$broadcast("loggedin",{user:g,loggedIn:!0}),g},getUser:function(){var e=t.defer();return g=a(),g?(g&&g.guild&&s(g),e.resolve(g)):e.reject("User doesn't exist"),e.promise},refreshUserFromServer:function(){var e=t.defer();return i.startLoading(),f.get().$promise.then(function(t){h.updateUser(),e.resolve()},function(t){console.log(t),e.reject(t)})["finally"](function(){i.loadingFinished()}),e.promise},logout:function(){var e=t.defer();return i.startLoading(),g=null,u.save({}).$promise.then(function(e){1==e.loggedOut&&r.$broadcast("loggedin",{loggedIn:!1}),n.path("/")},function(e){r.$broadcast("loggedin",{loggedIn:!1}),n.path("/")})["finally"](function(){i.loadingFinished()}),e.promise},registerNewUser:function(e){var o=t.defer();return console.log("Register new user"),i.startLoading(),c.save(e).$promise.then(function(e){g=a(),s(g),h.updateUser(),n.path("/")},function(e){console.log(e.data),o.reject(e.data)})["finally"](function(){i.loadingFinished()}),o.promise},login:function(e){var n=t.defer();return i.startLoading(),l.save(e).$promise.then(function(e){g=a(),s(g),r.$broadcast("loggedin",{user:g,loggedIn:!0}),i.hideLoadingBottomSheet()},function(e){n.reject(e.data)})["finally"](function(){i.loadingFinished()}),n.promise}};return h.refreshUserFromServer(),h}]);