"use strict";angular.module("BossCollection",["BossCollection.controllers","BossCollection.services","BossCollection.directives","BossCollection.filters","BossCollection.forums","ngRoute","ngResource","btford.socket-io","ngCookies","ngMaterial"]).factory("mySocket",["socketFactory",function(e){return e()}]).config(["$routeProvider","$locationProvider","$httpProvider","$sceDelegateProvider","$mdThemingProvider",function(e,t,o,n,r){r.theme("default").primaryPalette("deep-orange",{"default":"A700"}).accentPalette("grey",{"default":"900"}),e.when("/",{templateUrl:"home",controller:"homeController"}).when("/strategyRoom/:raid",{templateUrl:"strategyRoom",controller:"strategyRoomController"}).when("/roster",{templateUrl:"roster",controller:"rosterController"}).when("/auth/signup",{templateUrl:"signup",controller:"signupController"}).when("/auth/updateAccount",{templateUrl:"editAccount",controller:"editAccountController"}).when("/auth/application",{templateUrl:"application",controller:"applicationController"}).when("/auth/absence",{templateUrl:"absence",controller:"absenceController"}).when("/reviewApplications",{templateUrl:"reviewApplications",controller:"applicationsReviewController"}).when("/createGuild",{templateUrl:"createGuild",controller:"createGuildController"}).when("/joinGuild",{templateUrl:"joinGuild",controller:"joinGuildController"}).when("/manageMembers",{templateUrl:"manageMembers",controller:"manageMembersController"}).when("/whosOut",{templateUrl:"absenceSubmissions",controller:"absenceController"}).otherwise({redirectTo:"/"}),t.hashPrefix("!"),n.resourceUrlWhitelist(["self","https://www.youtube.com/**","https://pagead2.googlesyndication.com"]),t.html5Mode(!0)}]),angular.module("BossCollection.forums",["ngRoute"]).config(["$routeProvider",function(e){e.when("/forum",{templateUrl:"forum",controller:"forumController"}).when("/forum/:forumID",{templateUrl:"thread",controller:"threadController"})}]),angular.module("BossCollection.forums").controller("dialogController",["$scope","$location","siteServices","forumService","$mdBottomSheet","$mdDialog","data",function(e,t,o,n,r,i,a){e.object={},e.loading=!1,e.replying=!1,e.comment="",a?e.object=a:e.object={},e.cancel=function(){i.cancel()},e.cancelComment=function(){e.replying=!1},e.saveComment=function(){n.saveComment().then(function(){e.comment=""})},e.openCommentBox=function(){e.replying=!0},e.close=function(){i.hide(e.object)},e.saveCategory=function(){e.loading=!1,n.createNewCategory().then(function(t){e.close()})["catch"](function(e){})["finally"](function(){e.loading=!1})},e.saveForum=function(){e.loading=!1,n.createNewForum().then(function(){e.close()})["catch"](function(e){})["finally"](function(){e.loading=!1})}}]),angular.module("BossCollection.forums").controller("forumController",["$scope","$location","siteServices","forumService","$mdBottomSheet","$mdDialog","$window",function(e,t,o,n,r,i,a){console.log("Forum Controller loaded"),o.updateTitle("Forums"),e.testListCount=[];for(var l=0;5>l;l++)e.testListCount.push(l);e.markdown="",e.init=function(){n.getForums().then(function(t){e.forums=t})},e.newCategory=function(){e.category={},n.openBottomSheet("category")},e.editCategory=function(e){n.openBottomSheet("category",{object:e}).then(function(e){})["catch"](function(e){})},e.deleteCategory=function(e){n.confirmDelete().then(function(t){t&&(console.log("Deleting the category"),n.deleteCategory(e))})},e.createForum=function(){n.openBottomSheet("forumEdit")},e.editForum=function(e){n.openBottomSheet("category",{object:e}).then(function(e){console.log(e)})},e.deleteForum=function(e){n.confirmDelete().then(function(t){t&&(console.log("Deleting the forum"),n.deleteForum(e))})},e.goToForum=function(e){n.setForum(e),t.url("/forum/"+e._id)},e.init()}]),angular.module("BossCollection.forums").service("forumService",["$location","$mdDialog","$q","$routeParams","siteServices","$mdMedia","$rootScope",function(e,t,o,n,r,i,a){function l(e){B=e}function s(){var e=o.defer();return B?e.resolve(B):e.resolve(M.categories[0].forums[0]),e.promise}function c(e){}function u(e){}function d(e){}function g(e){}function m(e){}function f(e){}function h(e){}function p(e){}function v(e){var t=o.defer();return t.resolve(e),t.promise}function w(){var e=o.defer();return e.resolve(M),e.promise}function b(e){var t=o.defer();return t.resolve(e),t.promise}function y(e){var t=o.defer();return t.resolve(e),t.promise}function S(e){var t=o.defer();return t.resolve(e),t.promise}function C(e,n){var r=o.defer(),i=t.confirm().title("Are you sure you want to delete this?").textContent("This is irreversable once you click Yes!").ariaLabel("Confirm Delete").targetEvent(e).ok("Delete").cancel("Nevermind");return t.show(i).then(function(){r.resolve(!0)},function(e){r.reject(!1)}),r.promise}function $(e,n){var r=o.defer(),a=i("xs")||i("sm");(i("sm")||i("xs"))&&a;return t.show({templateUrl:e,controller:"dialogController",parent:angular.element(document.body),clickOutsideToClose:!1,locals:{data:n},fullscreen:!0}).then(function(e){r.resolve(e)},function(){r.reject()}),r.promise}function I(){t.hide()}var B={},M={categories:[{name:"Strategy",forums:[{name:"HM",threads:[{title:"Test Title",user:"tester",comments:[{user:"chanpod",message:"I'm leaving a message for this thread. It will be very long. I'm leaving a message for this thread. It will be very long. I'm leaving a message for this thread. It will be very long. I'm leaving a message for this thread. It will be very long. I'm leaving a message for this thread. It will be very long. I'm leaving a message for this thread. It will be very long. I'm leaving a message for this thread. It will be very long. I'm leaving a message for this thread. It will be very long. I'm leaving a message for this thread. It will be very long. I'm leaving a message for this thread. It will be very long. I'm leaving a message for this thread. It will be very long. I'm leaving a message for this thread. It will be very long."},{user:"test",message:"I'm leaving a message for this thread. It will be very long. I'm leaving a message for this thread. It will be very long. I'm leaving a message for this thread. It will be very long. I'm leaving a message for this thread. It will be very long. I'm leaving a message for this thread. It will be very long. I'm leaving a message for this thread. It will be very long. I'm leaving a message for this thread. It will be very long. I'm leaving a message for this thread. It will be very long. I'm leaving a message for this thread. It will be very long. I'm leaving a message for this thread. It will be very long. I'm leaving a message for this thread. It will be very long. I'm leaving a message for this thread. It will be very long."},{user:"tester",message:"I'm leaving a message for this thread. It will be very long. I'm leaving a message for this thread. It will be very long. I'm leaving a message for this thread. It will be very long. I'm leaving a message for this thread. It will be very long. I'm leaving a message for this thread. It will be very long. I'm leaving a message for this thread. It will be very long. I'm leaving a message for this thread. It will be very long. I'm leaving a message for this thread. It will be very long. I'm leaving a message for this thread. It will be very long. I'm leaving a message for this thread. It will be very long. I'm leaving a message for this thread. It will be very long. I'm leaving a message for this thread. It will be very long."}],message:"I created a thread!"},{title:"Test Title",user:"test",comments:[],message:"I created a thread!"},{title:"Test Title",user:"test2",comments:[],message:"I created a thread!"}]},{name:"BRF",threads:[{title:"Test",user:"Tester",comments:[],message:"I created a thread!"},{title:"Test",user:"Tester",comments:[],message:"I created a thread!"},{title:"Test",user:"Tester",comments:[],message:"I created a thread!"}]},{name:"HFC",threads:[{title:"Test",user:"Tester",comments:[],message:"I created a thread!"},{title:"Test",user:"Tester",comments:[],message:"I created a thread!"},{title:"Test",user:"Tester",comments:[],message:"I created a thread!"}]}]},{name:"General",forums:[{name:"Whatever"},{name:"Real Life"},{name:"Other Games"}]}]};return{setForum:l,confirmDelete:C,openBottomSheet:$,createNewCategory:v,deleteCategory:p,editForum:S,createNewForum:y,deleteForum:b,cancel:I,getForums:w,getThreads:c,getCurrentForum:s,deleteThread:u,editThread:d,createThread:g,deleteComment:m,editComment:f,createComment:h}}]),angular.module("BossCollection.forums").controller("threadController",["$scope","$location","siteServices","forumService","$mdBottomSheet","$mdDialog",function(e,t,o,n,r,i){console.log("Thread Controller Loaded"),e.forum={},e.loading=!1,e.init=function(){e.forum=n.getCurrentForum().then(function(t){e.forum=t}).then(function(){return o.updateTitle(e.forum.name+" Forum"),n.getThreads(e.forum)}).then(function(t){e.threads=t})},e.openThread=function(e){n.openBottomSheet("threadComments",e)},e.goBack=function(){window.history.back()},e.init()}]),angular.module("BossCollection.controllers",[]),angular.module("BossCollection.controllers").controller("homeController",["$scope","$location","$http","$timeout","siteServices","$sce",function(e,t,o,n,r,i){r.updateTitle("Home")}]),angular.module("BossCollection.controllers").controller("navbar",["$scope","$location","$http","userLoginSrvc","$rootScope","$mdSidenav","siteServices",function(e,t,o,n,r,i,a){function l(e){return function(){i(e).toggle()}}function s(){n.getUser().then(function(t){t&&(e.user=t,e.loggedIn=!0)},function(t){e.user.name="",e.loggedIn=!1})}var c;e.user={},e.user.name="",e.loggedIn=!1,e.title="",e.init=function(){s()},e.showLoginBottomSheet=function(e){a.showLoadingBottomSheet(e)},e.openMenu=function(e,t){c=t,e(t)},e.goTo=function(o){t.url(o),e.toggle()},e.goToExternal=function(e){window.open(e,"_blank")},r.$on("navbarTitle",function(t,o){e.title=o}),r.$on("loggedin",function(e,t){s()}),e.logout=function(){n.logout().then(function(e){},function(e){console.log(e)})},e.areWeLoggedIn=function(){n.getUser().then(function(t){e.loggedIn=!0})["catch"](function(t){e.loggedIn=!1})},e.openSideBar=function(e){i(e).open()},e.closeSideBar=function(e){i(e).close()},e.toggle=l("left"),e.init()}]),angular.module("BossCollection.controllers").controller("rosterController",["$scope","filterFilter","socketProvider","guildServices","$http","$cookies","$location","siteServices",function(e,t,o,n,r,i,a,l){function s(){var t=i.getObject("ranksList");t&&(e.raiderRanks=t.raiderRanks,e.trialRanks=t.trialRanks,e.guild=t.guild,e.realm=t.realm)}l.updateTitle("Guild Roster"),e.currentRosterDropdown=!0,e.applicantsDropdown=!1;var c=["placeholder","warrior","paladin","hunter","rogue","priest","death knight","shaman","mage","warlock","monk","druid"];e.raiders=[],e.trials=[],e.trialRanks=[9],e.raiderRanks=[0,2,6],e.guild="mkdir bosscollection",e.realm="zul'jin",e.loading=!0,e.genders=["Male","Female"],s(),$("ul.tabs").tabs(),e.getMembers=function(){e.raiders=[],e.trials=[],e.loading=!0,n.getGuild(e.realm,e.guild).then(function(t){console.log(t),e.loading=!1,d(t)},function(t){e.loading=!1,console.log(t)})},e.getUser=function(){r({method:"POST",url:"/getUser"}).success(function(e){console.log(e)})},e.openArmoryProfile=function(e,t){var o="http://us.battle.net/wow/en/character/"+t+"/"+e+"/simple";window.open(o)},e.saveRanksList=function(){var t={guild:e.guild,realm:e.realm,trialRanks:e.trialRanks,raiderRanks:e.raiderRanks};i.putObject("ranksList",t)};var u=function(t,o,n){try{var r={name:t.character.name,"class":n.charAt(0).toUpperCase()+n.slice(1),rank:o,gender:e.genders[t.character.gender],race:t.character.race,spec:t.character.spec.name,achievementPoints:t.character.achievementPoints,avatar:"http://us.battle.net/static-render/us/"+t.character.thumbnail};return r}catch(i){console.log(t)}},d=function(t){for(var o=0;o<t.length;o++){var n=t[o].rank,r=_.find(e.raiderRanks,function(e){return n==e}),i=_.find(e.trialRanks,function(e){return n==e}),a=c[t[o].character["class"]];r&&e.raiders.push(u(t[o],n,a)),i&&e.trials.push(u(t[o],n,a))}e.raiders.sort(function(e,t){return e.rank-t.rank})};e.lowLvlTrials=[],e.getMembers()}]),angular.module("BossCollection.controllers").controller("absenceController",["$scope","$location","userLoginSrvc","absenceService","siteServices","$filter",function(e,t,o,n,r,i){moment().day();e.newAbsence={},e.absences={},e.loading=!1,e.typePicked=!1,e.today=moment(),e.dayDesired,e.currentlySelected=moment().format("dddd - Do"),e.toolbar={isOpen:!1,direction:"right"},e.currentlySelected="Today",e.isToolSetOpen=!1,"/auth/absence"==t.url()?r.updateTitle("Report Absence"):r.updateTitle("Upcoming Absences"),e.updateList=function(){e.currentlySelected=moment(e.dayDesired).format("dddd - Do"),e.getAbsencesByDate()},e.formatDate=function(e){return moment.utc(e).format("dddd, MMM D")},e.getAbsences=function(){e.currentlySelected="All absences",e.loading=!0,n.getAbsences().then(function(t){e.loading=!1,e.absences=t.absences},function(t){r.showMessageToast(t),e.loading=!1,console.log(t)})},e.getAbsencesByDate=function(){e.loading=!0,n.getAbsencesByDate(e.dayDesired).then(function(t){e.loading=!1,e.absences=t.absences},function(t){r.showMessageToast(t),e.loading=!1,console.log(t)})},e.submitNewAbsence=function(){null==e.newAbsence.date?r.showMessageModal("Must select a date"):null==e.newAbsence.type?r.showMessageModal("Must select a type: Late or Absent"):n.submitNewAbsence(e.newAbsence).then(function(e){t.path("/whosOut")},function(e){Materialize.toast(e),console.log(e)})}}]),angular.module("BossCollection.controllers").controller("editAccountController",["$scope","$location","$http","userLoginSrvc","siteServices","guildServices",function(e,t,o,n,r,i){r.updateTitle("Account"),e.leaveGuild=function(){var t=e.user.guild.name;i.leaveGuild(t).then(function(t){e.user=n.updateUser()})},e.updateAccount=function(){console.log("Updating account"),n.updateAccount(e.user).then(function(t){e.user=n.updateUser(),r.showMessageToast("User updated")},function(e){r.showMessageModal(e)})}}]),angular.module("BossCollection.controllers").controller("loginController",["$scope","$location","$http","userLoginSrvc","siteServices","$mdBottomSheet","$timeout",function(e,t,o,n,r,i,a){e.user={},e.user.name="",e.loading=!1,"/auth/login"==t.url()&&r.updateTitle("Login"),console.log("Login Controller"),e.init=function(){},e.resetPassword=function(){e.loading=!0,n.lostPassword(e.user.email).then(function(e){r.showMessageModal("Email has been sent. Refer to your email for your temporary password.")})["catch"](function(e){r.showMessageModal(e)})["finally"](function(){e.loading=!1})},e.alreadyLoggedIn=function(){1==n.loggedIn()&&t.path("/")},e.openPasswordResetWindow=function(e){i.show({templateUrl:"resetPassword",controller:"loginController",targetEvent:e,escapeToClose:!1})},e.cancelPasswordReset=function(){i.hide(),a(function(){r.showLoadingBottomSheet()},500)},e.login=function(){n.login(e.user).then(function(e){console.log(e),n.getUser().then(function(){"/auth/application"==t.path()||t.path("/")})},function(e){r.showMessageModal(e),console.log(e)})},e.cancelLogin=function(){r.hideBottomSheet(),t.path("/")}}]),angular.module("BossCollection.controllers").controller("signupController",["$scope","$location","$http","$timeout","userLoginSrvc","siteServices",function(e,t,o,n,r,i){e.user={},e.passwordsMatch=!1,$("#logInModal").closeModal(),e.register=function(){r.registerNewUser(e.user).then(function(e){console.log(e)},function(t){e.passwordsMatch=!0,e.openFromLeft(t),console.log(t)})},e.openFromLeft=function(e){i.showMessageModal(e)}}]),angular.module("BossCollection.controllers").controller("applicationController",["$scope","$location","$http","$timeout","$filter","realmServices","guildServices","userLoginSrvc","siteServices",function(e,t,o,n,r,i,a,l,s){s.updateTitle("Applications"),console.log("Loading application ctrl..."),e.application={},e.validCharacterName=!1,e.charRequirementsIncomplete=!1,e.charRealmError=!1,e.searchingForUser=!1,e.icon="error",e.init=function(){i.getRealms().then(function(t){e.realms=t}).then(function(){return e.loggedIn()})["catch"](function(e){console.log(e)})["finally"](function(){n(function(){s.hideLoadingModal()},500)})},e.filterSearch=function(t){return r("filter")(e.realms,t)},e.loggedIn=function(){l.getUser().then(function(e){})["catch"](function(e){s.showMessageModal("Please log in before attempting to apply."),t.path("/")})["finally"](function(){})},e.validateCharactername=function(t){e.application.realm?(e.validCharacterName=!1,e.searchingForUser=!0,a.validateCharacterName(e.application.characterName,e.application.realm.name).then(function(o){e.validCharacterName=!0,e.icon="check_circle",e.application.character=o,t&&t()},function(t){e.icon="error",s.showMessageToast(t),e.validCharacterName=!1})["finally"](function(){e.searchingForUser=!1})):(e.validCharacterName=!1,t&&t())},e.submitApplication=function(){e.validateCharactername(function(){0==e.validCharacterName?s.showMessageToast("Sorry, we couldn't find your character. Please verify your Realm and Character are correct."):a.submitApplication(e.application).then(function(e){t.path("/reviewApplications")},function(e){s.showMessageToast(e)})})},e.init()}]),angular.module("BossCollection.controllers").controller("applicationsReviewController",["$scope","$location","$http","$timeout","guildServices","siteServices",function(e,t,o,n,r,i){function a(){for(var t=0;t<e.applications.length;t++){var o=l[e.applications[t].character["class"]];e.applications[t].character["class"]=o.charAt(0).toUpperCase()+o.slice(1)}}i.updateTitle("View Applications");var l=["placeholder","warrior","paladin","hunter","rogue","priest","death knight","shaman","mage","warlock","monk","druid"];e.loading=!0,e.openComments=function(e){i.showMessageModal(e,"Comments")},e.goTo=function(e){var t=window.open(e,"_blank");t.focus()},e.buildArmoryUrl=function(t,o){var n="http://us.battle.net/wow/en/character/"+t+"/"+o+"/simple";e.goTo(n)},r.getApplications().then(function(t){e.loading=!1,e.applications=t.applications,console.log(e.applications),a()},function(t){e.loading=!1,console.log(t),i.showMessageToast("Seems something broke. Try again in a few...")})}]),angular.module("BossCollection.controllers").controller("forumsController",["$scope","$location","$http","userLoginSrvc","$rootScope",function(e,t,o,n,r){e.user.name=n.getUser(),void 0==e.user.name&&t.path("/")}]),angular.module("BossCollection.controllers").controller("createGuildController",["$scope","$location","$http","$timeout","siteServices","guildServices","userLoginSrvc",function(e,t,o,n,r,i,a){r.updateTitle("Create Guild"),e.guildName="",e.loading=!1,e.joinGuild=function(){e.loading=!0,i.createGuild(e.guildName).then(function(){var e=a.updateUser();r.showMessageModal("Successfully created "+e.guild.name),t.path("/")})["catch"](function(e){r.showMessageModal(e)})["finally"](function(){e.loading=!1})}}]),angular.module("BossCollection.controllers").controller("joinGuildController",["$scope","$location","$http","$timeout","siteServices","guildServices","userLoginSrvc","$filter",function(e,t,o,n,r,i,a,l){e.listOfGuilds=[],e.loading=!1,r.updateTitle("Join Guild"),e.init=function(){e.getGuilds()},e.filterSearch=function(t){return l("filter")(e.listOfGuilds,t)},e.getGuilds=function(){i.getListOfGuilds().then(function(t){e.listOfGuilds=t})},e.joinGuild=function(){e.loading=!0,e.guildName?i.joinGuild(e.guildName.name,e.user.name).then(function(o){r.showMessageModal("Success! You will be able to access the guild services once you've been promoted to member."),a.updateUser(e.user),t.path("/")})["catch"](function(e){r.showMessageModal(e)})["finally"](function(){e.loading=!1}):(r.showMessageToast("Guild doesn't exist"),e.loading=!1)},e.init()}]),angular.module("BossCollection.controllers").controller("manageMembersController",["$scope","$location","$http","$timeout","siteServices","guildServices","userLoginSrvc","$filter",function(e,t,o,n,r,i,a,l){e.guildMembers,e.ranks=["Applicant","Member","Officer","GM"],e.init=function(){""!=e.user.name?i.getGuildMembers(e.user.guild.name).then(function(t){e.guildMembers=t}):a.getUser().then(function(t){i.getGuildMembers(t.guild.name).then(function(t){e.guildMembers=t})})},e.promote=function(t){3==t.rank?r.showMessageModal("Can't promote any further"):(t.rank++,i.updateRank(e.user.guild.name,t).then(function(){})["catch"](function(e){r.showMessageModal(e)}))},e.demote=function(t){1==t.rank?r.showMessageModal("Can't demote any further. They are effectively kicked at this rank."):(t.rank--,i.updateRank(e.user.guild.name,t).then(function(){})["catch"](function(e){r.showMessageModal(e)}))},e.init(),r.updateTitle("Manage Members")}]),angular.module("BossCollection.controllers").controller("strategyRoomController",["$scope",function(e){}]),angular.module("BossCollection.controllers").controller("bossStrategyController",["$scope","bossStrats","socketProvider","$routeParams",function(e,t,o,n){function r(){for(var t in e.raidToDisplay)e.raidToDisplay[t].isSelected=!1}function i(){document.getElementById("sideNavID").style.height=window.outerHeight/2+"px"}function a(e){return/(?:https?:\/\/|www\.|m\.|^)youtu(?:be\.com\/watch\?(?:.*?&(?:amp;)?)?v=|\.be\/)([\w‌​\-]+)(?:&(?:amp;)?[\w\?=]*)?/.test(e)}e.highmaulBossSelected=!1,e.brfBossSelected=!1,e.hfcBossSelected=!1,$(".modal-trigger").leanModal();var l=n.raid;e.highmaul="hm",e.brf="brf",e.hfc="hfc",e.bossInfo={},e.loadChat=!1,e.difficultySelected="",e.currentEmbedUrl="",e.addNewBoss=!1,e.currentRaid={},e.raidToDisplay={},e.name="",e.url="",e.init=function(){i(),t.getStrats(l).then(function(t){e.raidToDisplay=t.bosses,e.raidData=t,r()})},e.addVideo=function(t,o,n){e.currentBoss=t,e.currentDifficulty=o,e.currentRaid=n},e.saveNewBossInfo=function(o,n,r,i){if(console.log(r),a(n)){var l=n.split("&");l=l[0].split("="),n=l[1],"heroic"==i?r.heroic.videos[r.heroic.videos.length]={name:o,url:n}:"mythic"==i&&(r.mythic.videos[r.mythic.videos.length]={name:o,url:n}),e.raidData.bosses=e.raidToDisplay,console.log(e.raidData),t.saveStrats(e.raidData,n),e.addNewBoss=!1,e.name="",e.url="",e.addNewBoss=!e.addNewBoss}else $("#urlInput").popover("show")},e.changeBossInfo=function(t,o){t.isSelected=!t.isSelected,e.bossSelected=t.name,e.addNewBoss=!1},e.changeDifficulty=function(e,t){e.difficultySelected=t,"- Heroic"==t?(e.heroic.isSelected=!e.heroic.isSelected,e.mythic.isSelected=!1):(e.mythic.isSelected=!e.mythic.isSelected,e.heroic.isSelected=!1)},e.setUrl=function(t){e.currentEmbedUrl=t},e.open=function(t){e.setUrl(t),console.log(t),$("#bossVideo").openModal()},e.init()}]),angular.module("BossCollection.controllers").controller("bossStrategyController",["$scope","bossStrats","$modal","socketProvider","$routeParams",function(e,t,o,n,r){function i(){for(var t in e.raidToDisplay)e.raidToDisplay[t].isSelected=!1}function a(){document.getElementById("sideNavID").style.height=window.outerHeight/2+"px"}function l(e){return/(?:https?:\/\/|www\.|m\.|^)youtu(?:be\.com\/watch\?(?:.*?&(?:amp;)?)?v=|\.be\/)([\w‌​\-]+)(?:&(?:amp;)?[\w\?=]*)?/.test(e)}e.highmaulBossSelected=!1,e.brfBossSelected=!1,e.hfcBossSelected=!1;var s=r.raid;e.highmaul="hm",e.brf="brf",e.hfc="hfc",e.bossInfo={},e.loadChat=!1,e.difficultySelected="",e.currentEmbedUrl="",e.addNewBoss=!1,e.currentRaid={},e.raidToDisplay={},e.name="",e.url="",e.init=function(){a(),t.getStrats(s).then(function(t){e.raidToDisplay=t.bosses,e.raidData=t,i()})},e.addVideo=function(t,o,n){e.currentBoss=t,e.currentDifficulty=o,e.currentRaid=n},e.saveNewBossInfo=function(o,n,r,i){if(console.log(r),l(n)){var a=n.split("&");a=a[0].split("="),n=a[1],"heroic"==i?r.heroic.videos[r.heroic.videos.length]={name:o,url:n}:"mythic"==i&&(r.mythic.videos[r.mythic.videos.length]={name:o,url:n}),e.raidData.bosses=e.raidToDisplay,console.log(e.raidData),t.saveStrats(e.raidData,n),e.addNewBoss=!1,e.name="",e.url="",e.addNewBoss=!e.addNewBoss}else $("#urlInput").popover("show")},e.changeBossInfo=function(t,o){t.isSelected=!t.isSelected,e.bossSelected=t.name,e.addNewBoss=!1},e.changeDifficulty=function(e,t){e.difficultySelected=t,"- Heroic"==t?(e.heroic.isSelected=!e.heroic.isSelected,e.mythic.isSelected=!1):(e.mythic.isSelected=!e.mythic.isSelected,e.heroic.isSelected=!1)},e.setUrl=function(t){e.currentEmbedUrl=t},e.open=function(t){e.setUrl(t),console.log(t);o.open({templateUrl:"videoModal",controller:"videoController",size:"lg",windowClass:"videoModal",resolve:{currentUrl:function(){return e.currentEmbedUrl}}})},e.init()}]),angular.module("BossCollection.controllers").controller("videoController",["$scope","currentUrl","$modalInstance",function(e,t,o){e.url=t,e.getIframeSrc=function(){return"https://www.youtube.com/embed/"+e.url},e.close=function(){o.dismiss("cancel")},e.embedUrl=e.url}]),angular.module("BossCollection.directives",[]),angular.module("BossCollection.directives").directive("ad",[function(){return{restrict:"E",template:'<ins class="adsbygoogle"style="display:block;"data-ad-client="ca-pub-4895481554192451"data-ad-slot="1814022675"data-ad-format="auto">',link:function(e,t,o){try{(adsbygoogle=window.adsbygoogle||[]).push({})}catch(n){console.log("Add code broke"),console.log(n)}}}}]),angular.module("BossCollection.directives").directive("bossstrategies",[function(){return{restrict:"E",templateUrl:"bossStrategy",controller:"bossStrategyController",link:function(e,t,o){}}}]),angular.module("BossCollection.directives").directive("logIn",[function(){return{restrict:"E",templateUrl:"login",controller:"loginController",link:function(e,t,o){}}}]),angular.module("BossCollection.directives").directive("inputMarkdown",["$sce",function(e){return{restrict:"E",scope:{input:"=input"},link:function(t){var o=new showdown.Converter;t.markdown=t.input,t.showPreview=!0,t.goToExternal=function(e){window.open(e,"_blank")},t.converToHtml=function(){t.html=e.trustAsHtml(o.makeHtml(t.markdown)),t.input=t.markdown},t.hideShowPreview=function(){t.showPreview=!t.showPreview},t.converToHtml(t.markdown)},templateUrl:"inputField"}}]),angular.module("BossCollection.filters",[]),angular.module("BossCollection.filters").filter("applicants",[function(){return function(e){var t=[];return t=_.filter(e,function(e){return 1==e.rank}),t.length}}]),angular.module("BossCollection.filters").filter("interpolate",function(e){return function(t){return String(t).replace(/\%VERSION\%/gm,e)}}),angular.module("BossCollection.services",[]),angular.module("BossCollection.services").factory("absenceService",["$resource","$q","$location","$cookies","$rootScope","siteServices",function(e,t,o,n,r,i){var a=e("/api/absence",{},{}),l=e("/api/absenceByDate",{},{}),s={submitNewAbsence:function(e){var o=t.defer();return i.startLoading(),a.save(e).$promise.then(function(e){o.resolve(e)},function(e){console.log(e),o.reject(e.data)})["finally"](function(){i.loadingFinished()}),o.promise},getAbsences:function(){var e=t.defer();return a.get().$promise.then(function(t){e.resolve(t)},function(t){console.log(t),e.reject(t.data)})["finally"](function(){i.loadingFinished()}),e.promise},getAbsencesByDate:function(e){var o=t.defer();return l.save({date:e}).$promise.then(function(e){o.resolve(e)},function(e){console.log(e),o.reject(e.data)})["finally"](function(){i.loadingFinished()}),o.promise}};return s}]),angular.module("BossCollection.services").factory("bossStrats",["socketProvider","$resource","$q",function(e,t,o){var n=t("/api/bossStrats",{},{update:{method:"PUT"}}),r={getStrats:function(e){var t=o.defer();console.log("Request Boss Info");var r={name:e};return n.save(r).$promise.then(function(e){console.log("Result: "),console.log(e),t.resolve(e.result)}),t.promise},saveStrats:function(e,t){console.log("Saving info now");var o={raidData:e,url:t};o=angular.toJson(o),console.log(o),n.data=o,n.update(o,function(e){console.log("Result: "+e)})}};return r}]),angular.module("BossCollection.services").factory("guildServices",["$http","$q","$resource","siteServices","userLoginSrvc","socketProvider",function(e,t,o,n,r,i){var a="https://us.api.battle.net/wow/guild/",l="?fields=members&locale=en_US&apikey=fqvadba9c8auw7brtdr72vv7hfntbx7d",s=o("/api/applicationSubmission",{},{}),c=o("/api/getApplications",{},{}),u=o("/api/addGuild",{},{}),d=o("/api/updateRank",{},{}),g=(o("/api/changeGuildName",{},{}),o("/api/addMember",{},{})),m=o("/api/removeMember",{},{}),f=o("/api/getGuildMembers",{},{}),h=o("/api/listOfGuilds",{},{}),p={getListOfGuilds:function(){var e=t.defer();return n.startLoading(),h.get().$promise.then(function(t){e.resolve(t.guilds)})["catch"](function(t){e.reject(t.data.message)})["finally"](function(){n.loadingFinished()}),e.promise},updateRank:function(e,o){var r=t.defer();return d.save({guildName:e,member:o}).$promise.then(function(e){r.resolve(e.members)})["catch"](function(e){r.reject(e.data.message)})["finally"](function(){n.loadingFinished()}),r.promise},getGuildMembers:function(e){var o=t.defer();return n.startLoading(),f.save({guildName:e}).$promise.then(function(e){o.resolve(e.members)})["catch"](function(e){o.reject(e.data.message)})["finally"](function(){n.loadingFinished()}),o.promise},createGuild:function(e){var o=t.defer();return u.save({guildName:e}).$promise.then(function(e){o.resolve(e.guild)})["catch"](function(e){o.reject(e.data.message)})["finally"](function(){}),o.promise},joinGuild:function(e,o){var n=t.defer();return g.save({guildName:e,memberName:o}).$promise.then(function(e){n.resolve(e.guild)})["catch"](function(e){n.reject(e.data.message)})["finally"](function(){}),n.promise},leaveGuild:function(e){var o=t.defer();return n.startLoading(),m.save({guildName:e}).$promise.then(function(e){o.resolve(e.user)})["catch"](function(e){o.reject(e.data.message)})["finally"](function(){n.loadingFinished()}),o.promise},getApplications:function(){var e=t.defer();return n.startLoading(),c.get().$promise.then(function(t){e.resolve(t)},function(t){e.reject(t)})["finally"](function(){n.loadingFinished()}),e.promise},validateCharacterName:function(e,n){var r=t.defer(),i="https://us.api.battle.net/wow/character/"+n+"/"+e+"?locale=en_US&apikey=fqvadba9c8auw7brtdr72vv7hfntbx7d",a=o(i,{},{});return a.get().$promise.then(function(e){r.resolve(e)},function(e){r.reject("Character not found")}),r.promise},getGuild:function(o,r){var i=t.defer();if(n.startLoading(),""!=o&&""!=r)var s=a+encodeURIComponent(o)+"/"+encodeURIComponent(r)+l;return e({method:"GET",url:s}).then(function(e){i.resolve(e.data.members)},function(e){i.reject(e)})["finally"](function(){n.loadingFinished()}),i.promise},submitApplication:function(e){var r=t.defer(),i="https://us.api.battle.net/wow/character/"+e.realm.name+"/"+e.character.name+"?fields=talents&locale=en_US&apikey=fqvadba9c8auw7brtdr72vv7hfntbx7d",a=o(i,{},{});return n.startLoading(),a.get().$promise.then(function(e){return e},function(e){r.reject("Character not found")}).then(function(t){e.character.specs=t.talents,s.save({newApplicant:e}).$promise.then(function(e){n.loadingFinished(),r.resolve(e)},function(e){r.reject(e)})})["finally"](function(){n.loadingFinished()}),r.promise}};return p}]),angular.module("BossCollection.services").factory("realmServices",["$http","$q","siteServices",function(e,t,o){var n="https://us.api.battle.net/wow/realm/status?locale=en_US&apikey=fqvadba9c8auw7brtdr72vv7hfntbx7d",r=[],i={getRealms:function(){var i=t.defer();return 0==r.length?e({method:"GET",url:n}).success(function(e){o.hideLoadingModal(),r=e.realms,i.resolve(r),r=r}):(o.hideLoadingModal(),i.resolve(r)),i.promise}};return i}]),angular.module("BossCollection.services").factory("siteServices",["$rootScope","$mdBottomSheet","$mdDialog","$mdToast",function(e,t,o,n){function r(){f||(f=!0,m())}function i(){g(),f=!1}function a(t){e.$broadcast("navbarTitle",t)}function l(e){t.show({templateUrl:"logInModal",controller:"loginController",targetEvent:e,escapeToClose:!1})}function s(){t.hide()}function c(){t.hide()}function u(e,t){
o.show(o.alert().clickOutsideToClose(!0).title(t).textContent(e).ariaLabel("message popup").ok("Got it!").openFrom({left:-50,width:30,height:80}).closeTo({right:1500}))}function d(e){n.show(n.simple().textContent(e).position("top").hideDelay(4e3))}function g(){0==f||(f=!1,o.hide())}function m(){o.show({templateUrl:"loadingModal",onComplete:function(){f||o.hide()}})}var f=!1;return{startLoading:r,loadingFinished:i,updateTitle:a,showLoadingBottomSheet:l,hideLoadingBottomSheet:s,showMessageModal:u,showMessageToast:d,hideBottomSheet:c,showLoadingModal:m,hideLoadingModal:g}}]),angular.module("BossCollection.services").factory("socketProvider",[function(){var e=io("http://localhost:4001/guilds");return e}]),angular.module("BossCollection.services").factory("userLoginSrvc",["$resource","$q","$location","$cookies","$rootScope","siteServices","socketProvider",function(e,t,o,n,r,i,a){function l(){var e=n.get("user"),t=void 0;if(e){var o=e.substring(e.indexOf("{"),e.lastIndexOf("}")+1);t=JSON.parse(o)}return t}function s(e){var t;return h&&h.guild?(t=_.find(h.guild.members,{user:h.name}),h.rank=t.rank,t.rank):e&&e.guild?(t=_.find(h.guild.members,{user:h.name}),t.rank):0}var c=e("/auth/signup",{},{}),u=e("/auth/login",{},{}),d=e("/auth/logout",{},{}),g=(e("/auth/loggedin",{},{}),e("/auth/updateAccount",{},{})),m=e("/auth/currentUser",{},{}),f=e("/auth/lost-password",{},{}),h=null,p={lostPassword:function(e){var o=t.defer();return f.save({email:e}).$promise.then(function(e){o.resolve(e)},function(e){o.reject(e.data.message)}),o.promise},updateAccount:function(e){var o=t.defer();return i.startLoading(),g.save(e).$promise.then(function(e){o.resolve(e)},function(e){console.log(e),o.reject(e.data.message)})["finally"](function(){i.loadingFinished()}),o.promise},updateUser:function(){return h=l(),h&&h.guild&&s(h),r.$broadcast("loggedin",{user:h,loggedIn:!0}),h},getUser:function(){var e=t.defer();return h=l(),h?(h&&h.guild&&s(h),e.resolve(h)):e.reject("User doesn't exist"),e.promise},refreshUserFromServer:function(){var e=t.defer();return i.startLoading(),m.get().$promise.then(function(t){p.updateUser(),e.resolve()},function(t){console.log(t),e.reject(t)})["finally"](function(){i.loadingFinished()}),e.promise},logout:function(){var e=t.defer();return i.startLoading(),h=null,d.save({}).$promise.then(function(e){1==e.loggedOut&&r.$broadcast("loggedin",{loggedIn:!1}),o.path("/")},function(e){r.$broadcast("loggedin",{loggedIn:!1}),o.path("/")})["finally"](function(){i.loadingFinished()}),e.promise},registerNewUser:function(e){var n=t.defer();return console.log("Register new user"),i.startLoading(),c.save(e).$promise.then(function(e){h=l(),s(h),p.updateUser(),o.path("/")},function(e){console.log(e.data),n.reject(e.data)})["finally"](function(){i.loadingFinished()}),n.promise},login:function(e){var o=t.defer();return i.startLoading(),u.save(e).$promise.then(function(e){h=l(),s(h),r.$broadcast("loggedin",{user:h,loggedIn:!0}),i.hideLoadingBottomSheet()},function(e){o.reject(e.data)})["finally"](function(){i.loadingFinished()}),o.promise}};return p.refreshUserFromServer(),p}]);